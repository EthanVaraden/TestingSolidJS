!function(){function e(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var i,n,o,s,a=[],l=!0,d=!1;try{if(o=(r=r.call(e)).next,0===t){if(Object(r)!==r)return;l=!1}else for(;!(l=(i=o.call(r)).done)&&(a.push(i.value),a.length!==t);l=!0);}catch(e){d=!0,n=e}finally{try{if(!l&&null!=r.return&&(s=r.return(),Object(s)!==s))return}finally{if(d)throw n}}return a}}(e,t)||o(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function t(){"use strict";/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */t=function(){return r};var e,r={},i=Object.prototype,n=i.hasOwnProperty,o=Object.defineProperty||function(e,t,r){e[t]=r.value},s="function"==typeof Symbol?Symbol:{},a=s.iterator||"@@iterator",l=s.asyncIterator||"@@asyncIterator",d=s.toStringTag||"@@toStringTag";function h(e,t,r){return Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{h({},"")}catch(e){h=function(e,t,r){return e[t]=r}}function u(e,t,r,i){var n=t&&t.prototype instanceof x?t:x,s=Object.create(n.prototype),a=new k(i||[]);return o(s,"_invoke",{value:I(e,r,a)}),s}function c(e,t,r){try{return{type:"normal",arg:e.call(t,r)}}catch(e){return{type:"throw",arg:e}}}r.wrap=u;var p="suspendedStart",f="suspendedYield",v="executing",g="completed",m={};function x(){}function y(){}function w(){}var b={};h(b,a,(function(){return this}));var _=Object.getPrototypeOf,T=_&&_(_(B([])));T&&T!==i&&n.call(T,a)&&(b=T);var S=w.prototype=x.prototype=Object.create(b);function C(e){["next","throw","return"].forEach((function(t){h(e,t,(function(e){return this._invoke(t,e)}))}))}function R(e,t){function r(i,o,s,a){var l=c(e[i],e,o);if("throw"!==l.type){var d=l.arg,h=d.value;return h&&"object"==typeof h&&n.call(h,"__await")?t.resolve(h.__await).then((function(e){r("next",e,s,a)}),(function(e){r("throw",e,s,a)})):t.resolve(h).then((function(e){d.value=e,s(d)}),(function(e){return r("throw",e,s,a)}))}a(l.arg)}var i;o(this,"_invoke",{value:function(e,n){function o(){return new t((function(t,i){r(e,n,t,i)}))}return i=i?i.then(o,o):o()}})}function I(t,r,i){var n=p;return function(o,s){if(n===v)throw Error("Generator is already running");if(n===g){if("throw"===o)throw s;return{value:e,done:!0}}for(i.method=o,i.arg=s;;){var a=i.delegate;if(a){var l=N(a,i);if(l){if(l===m)continue;return l}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if(n===p)throw n=g,i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);n=v;var d=c(t,r,i);if("normal"===d.type){if(n=i.done?g:f,d.arg===m)continue;return{value:d.arg,done:i.done}}"throw"===d.type&&(n=g,i.method="throw",i.arg=d.arg)}}}function N(t,r){var i=r.method,n=t.iterator[i];if(n===e)return r.delegate=null,"throw"===i&&t.iterator.return&&(r.method="return",r.arg=e,N(t,r),"throw"===r.method)||"return"!==i&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+i+"' method")),m;var o=c(n,t.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,m;var s=o.arg;return s?s.done?(r[t.resultName]=s.value,r.next=t.nextLoc,"return"!==r.method&&(r.method="next",r.arg=e),r.delegate=null,m):s:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function L(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function M(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(L,this),this.reset(!0)}function B(t){if(t||""===t){var r=t[a];if(r)return r.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var i=-1,o=function r(){for(;++i<t.length;)if(n.call(t,i))return r.value=t[i],r.done=!1,r;return r.value=e,r.done=!0,r};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return y.prototype=w,o(S,"constructor",{value:w,configurable:!0}),o(w,"constructor",{value:y,configurable:!0}),y.displayName=h(w,d,"GeneratorFunction"),r.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},r.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,w):(e.__proto__=w,h(e,d,"GeneratorFunction")),e.prototype=Object.create(S),e},r.awrap=function(e){return{__await:e}},C(R.prototype),h(R.prototype,l,(function(){return this})),r.AsyncIterator=R,r.async=function(e,t,i,n,o){void 0===o&&(o=Promise);var s=new R(u(e,t,i,n),o);return r.isGeneratorFunction(t)?s:s.next().then((function(e){return e.done?e.value:s.next()}))},C(S),h(S,d,"Generator"),h(S,a,(function(){return this})),h(S,"toString",(function(){return"[object Generator]"})),r.keys=function(e){var t=Object(e),r=[];for(var i in t)r.push(i);return r.reverse(),function e(){for(;r.length;){var i=r.pop();if(i in t)return e.value=i,e.done=!1,e}return e.done=!0,e}},r.values=B,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(M),!t)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var r=this;function i(i,n){return a.type="throw",a.arg=t,r.next=i,n&&(r.method="next",r.arg=e),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var s=this.tryEntries[o],a=s.completion;if("root"===s.tryLoc)return i("end");if(s.tryLoc<=this.prev){var l=n.call(s,"catchLoc"),d=n.call(s,"finallyLoc");if(l&&d){if(this.prev<s.catchLoc)return i(s.catchLoc,!0);if(this.prev<s.finallyLoc)return i(s.finallyLoc)}else if(l){if(this.prev<s.catchLoc)return i(s.catchLoc,!0)}else{if(!d)throw Error("try statement without catch or finally");if(this.prev<s.finallyLoc)return i(s.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var s=o?o.completion:{};return s.type=e,s.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(s)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.finallyLoc===e)return this.complete(r.completion,r.afterLoc),M(r),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var r=this.tryEntries[t];if(r.tryLoc===e){var i=r.completion;if("throw"===i.type){var n=i.arg;M(r)}return n}}throw Error("illegal catch attempt")},delegateYield:function(t,r,i){return this.delegate={iterator:B(t),resultName:r,nextLoc:i},"next"===this.method&&(this.arg=e),m}},r}function r(e,t,r,i,n,o,s){try{var a=e[o](s),l=a.value}catch(e){return void r(e)}a.done?t(l):Promise.resolve(l).then(i,n)}function i(e){return function(){var t=this,i=arguments;return new Promise((function(n,o){var s=e.apply(t,i);function a(e){r(s,n,o,a,l,"next",e)}function l(e){r(s,n,o,a,l,"throw",e)}a(void 0)}))}}function n(e,t){var r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=o(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0,n=function(){};return{s:n,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var s,a=!0,l=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return a=e.done,e},e:function(e){l=!0,s=e},f:function(){try{a||null==r.return||r.return()}finally{if(l)throw s}}}}function o(e,t){if(e){if("string"==typeof e)return s(e,t);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=Array(t);r<t;r++)i[r]=e[r];return i}function a(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,i)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?a(Object(r),!0).forEach((function(t){d(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):a(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function d(e,t,r){return(t=function(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var i=r.call(e,t||"default");if("object"!=typeof i)return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}System.register(["./CoreExtension-legacy-60c8U4Qv.js"],(function(r,o){"use strict";var s,a,h,u,c,p,f,v,g,m,x,y,w,b,_,T,S,C,R,I,N,L,M,k,B,F,E,A,z,P,O,$,D,Y;return{setters:[e=>{s=e.T,a=e.g,h=e.a,u=e.E,c=e.b,p=e.c,f=e.i,v=e.d,g=e.e,m=e.m,x=e.W,y=e.f,w=e.h,b=e.j,_=e.k,T=e.S,S=e.l,C=e.B,R=e.n,I=e.o,N=e.p,L=e.q,M=e.r,k=e.C,B=e.s,F=e.t,E=e.u,A=e.v,z=e.w,P=e.R,O=e.x,$=e.y,D=e.z,Y=e.A}],execute:function(){var U,W,H,X=t().mark(Be);r({b:et,d:tt,e:function(e,t,r){He=ct;var i=lt(e,t,!1,Xe),n=Ye&&function(e){var t;return Ve&&Ve.context&&void 0!==(t=Ve.context[e.id])?t:e.defaultValue}(Ye);n&&(i.suspense=n);i.user=!0,Ze?Ze.push(i):at(i)},f:function(e,t,r){var i,n=Array.isArray(e),o=r&&r.defer;return r=>{var s;if(n){s=Array(e.length);for(var a=0;a<e.length;a++)s[a]=e[a]()}else s=e();if(o)return o=!1,r;var l=nt((()=>t(s,i,r)));return i=s,l}},g:function(){return Ve},o:function(e){null===Ve||(null===Ve.cleanups?Ve.cleanups=[e]:Ve.cleanups.push(e));return e},u:nt});class j{static getEffectKey(e){return""}static getMethodParameters(e,t){var r=[];for(var i in e){var n=e[i],o="";n.size&&(o=`[${n.size(t)}]`),r.push(`${n.type} ${i}${o}`)}return r.join(",")}constructor(e){d(this,"priority",1),d(this,"name",""),d(this,"ref",void 0),d(this,"target",void 0),d(this,"passParameters",""),d(this,"declaredUniforms",""),d(this,"uniformInfo",{});var t=e.ref,r=e.target,i=e.props,n=void 0===i?{}:i;this.ref=t,this.target=r;var o={},s=[],a="",l=this.constructor.uniforms||{};for(var h in l){var u=l[h],c=u.type,p=`${t}_${h}`,f="";u.size&&(f=`[${u.size(n)}]`),s.push(p),a+=`uniform ${c} ${p}${f};`,o[h]={name:p,uniform:l[h].method}}this.passParameters=s.join(","),this.declaredUniforms=a,this.uniformInfo=o}static resolveDefaults(e){return{}}static makeEffectKey(e){return!1}}d(j,"uniforms",{}),d(j,"methods",void 0),d(j,"onShaderMask",void 0),d(j,"onColorize",void 0),d(j,"onEffectMask",void 0);var G={x:(e,t)=>{e.props.x=t},y:(e,t)=>{e.props.y=t},width:(e,t)=>{e.props.width=t},height:(e,t)=>{e.props.height=t},color:(e,t)=>{e.props.color=t},zIndex:(e,t)=>{e.props.zIndex=t},fontFamily:(e,t)=>{e.props.fontFamily=t},fontWeight:(e,t)=>{e.props.fontWeight=t},fontStyle:(e,t)=>{e.props.fontStyle=t},fontStretch:(e,t)=>{e.props.fontStretch=t},fontSize:(e,t)=>{e.props.fontSize=t},text:(e,t)=>{e.props.text=t},textAlign:(e,t)=>{e.props.textAlign=t},contain:(e,t)=>{e.props.contain=t},offsetY:(e,t)=>{e.props.offsetY=t},scrollable:(e,t)=>{e.props.scrollable=t},scrollY:(e,t)=>{e.props.scrollY=t},letterSpacing:(e,t)=>{e.props.letterSpacing=t},lineHeight:(e,t)=>{e.props.lineHeight=t},maxLines:(e,t)=>{e.props.maxLines=t},textBaseline:(e,t)=>{e.props.textBaseline=t},verticalAlign:(e,t)=>{e.props.verticalAlign=t},overflowSuffix:(e,t)=>{e.props.overflowSuffix=t},debug:(e,t)=>{e.props.debug=t}};class V{constructor(e){d(this,"stage",void 0),d(this,"set",void 0),this.stage=e;var t=l(l({},G),this.getPropertySetters());this.set=Object.freeze(Object.fromEntries(Object.entries(t).map((([e,t])=>[e,(r,i)=>{r.props[e]!==i&&(t(r,i),this.stage.requestRender())}]))))}setStatus(e,t,r){e.status!==t&&(e.status=t,e.emitter.emit(t,r))}setIsRenderable(e,t){e.isRenderable=t}destroyState(e){["loading","loaded","failed"].forEach((t=>{e.emitter.off(t)}))}scheduleUpdateState(e){e.updateScheduled||(e.updateScheduled=!0,queueMicrotask((()=>{e.updateScheduled=!1,this.updateState(e)})))}}class K extends s{constructor(e,t,r){super(e,t),d(this,"fontFace",void 0),d(this,"fontUrl",void 0);var i=r.replace(/\(|\)/g,""),n=this.descriptors,o={style:n.style,weight:"number"==typeof n.weight?`${n.weight}`:n.weight,stretch:n.stretch,unicodeRange:n.unicodeRange,variant:n.variant,featureSettings:n.featureSettings,display:n.display},s=new FontFace(e,`url(${i})`,o);s.load().then((()=>{this.loaded=!0,this.emit("loaded")})).catch(console.error),this.fontFace=s,this.fontUrl=r}}function q(e,t,r,i,n){return r*(i-1)+("bottom"!==e?.5*t:0)+Math.max(r,t)+(n||0)}class Q{constructor(e,t){d(this,"_canvas",void 0),d(this,"_context",void 0),d(this,"_settings",void 0),d(this,"renderInfo",void 0),this._canvas=e,this._context=t,this._settings=this.mergeDefaults({})}set settings(e){this._settings=this.mergeDefaults(e)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){for(var e=[this._settings.fontFace],t=[],r=0,i=e.length;r<i;r++)"serif"===e[r]||"sans-serif"===e[r]?t.push(e[r]):t.push(`"${e[r]}"`);return`${this._settings.fontStyle} ${this._settings.fontSize*this.getPrecision()}px ${t.join(",")}`}_load(){if(document.fonts){var e=this._getFontSetting();try{if(!document.fonts.check(e,this._settings.text))return document.fonts.load(e,this._settings.text).catch((t=>{console.warn("[Lightning] Font load error",t,e)})).then((()=>{document.fonts.check(e,this._settings.text)||console.warn("[Lightning] Font not found",e)}))}catch(t){console.warn("[Lightning] Can't check font loading for "+e)}}}calculateRenderInfo(){var e={},t=this.getPrecision(),r=this._settings.paddingLeft*t,i=this._settings.paddingRight*t,n=this._settings.fontSize*t,o=null===this._settings.offsetY?null:this._settings.offsetY*t,s=(this._settings.lineHeight||n)*t,a=this._settings.w*t,l=this._settings.h*t,d=this._settings.wordWrapWidth*t,h=this._settings.cutSx*t,u=this._settings.cutEx*t,c=this._settings.cutSy*t,p=this._settings.cutEy*t,f=(this._settings.letterSpacing||0)*t,v=this._settings.textIndent*t;this.setFontProperties();var g,m=a||2048/this.getPrecision(),x=m-r;if(x<10&&(m+=10-x,x=10),d||(d=x),this._settings.textOverflow&&!this._settings.wordWrap){var y;switch(this._settings.textOverflow){case"clip":y="";break;case"ellipsis":y=this._settings.overflowSuffix;break;default:y=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,d-v,y)}if(this._settings.wordWrap)g=this.wrapText(this._settings.text,d,f,v);else for(var w=(g={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]}).l.length,b=0;b<w-1;b++)g.n.push(b);var _=g.l;if(this._settings.maxLines&&_.length>this._settings.maxLines){var T,S=_.slice(0,this._settings.maxLines),C=null;if(this._settings.overflowSuffix){var R=this._settings.overflowSuffix?this.measureText(this._settings.overflowSuffix):0,I=this.wrapText(S[S.length-1],d-R,f,v);S[S.length-1]=`${I.l[0]}${this._settings.overflowSuffix}`,C=[I.l.length>1?I.l[1]:""]}else C=[""];var N=_.length,L=0,M=g.n.length;for(T=this._settings.maxLines;T<N;T++)C[L]+=`${C[L]?" ":""}${_[T]}`,T+1<M&&g.n[T+1]&&L++;e.remainingText=C.join("\n"),e.moreTextLines=!0,_=S}else e.moreTextLines=!1,e.remainingText="";for(var k,B=0,F=[],E=0;E<_.length;E++){var A=this.measureText(_[E],f)+(0===E?v:0);F.push(A),B=Math.max(B,A)}return e.lineWidths=F,a||(m=B+r+i,x=B),s=s||n,k=l||q(this._settings.textBaseline,n,s,_.length,o),null===o&&(o=n),e.w=m,e.h=k,e.lines=_,e.precision=t,m||(m=1),k||(k=1),(h||u)&&(m=Math.min(m,u-h)),(c||p)&&(k=Math.min(k,p-c)),e.width=m,e.innerWidth=x,e.height=k,e.fontSize=n,e.cutSx=h,e.cutSy=c,e.cutEx=u,e.cutEy=p,e.lineHeight=s,e.lineWidths=F,e.offsetY=o,e.paddingLeft=r,e.paddingRight=i,e.letterSpacing=f,e.textIndent=v,e}draw(e,t){var r,i,n=this.getPrecision(),o=(null==t?void 0:t.lines)||e.lines,s=(null==t?void 0:t.lineWidths)||e.lineWidths,l=t?q(this._settings.textBaseline,e.fontSize,e.lineHeight,t.lines.length,null===this._settings.offsetY?null:this._settings.offsetY*n):e.height;this._canvas.width=Math.min(Math.ceil(e.width+this._settings.textRenderIssueMargin),2048),this._canvas.height=Math.min(Math.ceil(l),2048),this.setFontProperties(),e.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(e.cutSx||e.cutSy)&&this._context.translate(-e.cutSx,-e.cutSy);for(var d=[],h=0,u=o.length;h<u;h++)r=0===h?e.textIndent:0,i=h*e.lineHeight+e.offsetY,"middle"==this._settings.verticalAlign?i+=(e.lineHeight-e.fontSize)/2:"bottom"==this._settings.verticalAlign&&(i+=e.lineHeight-e.fontSize),"right"===this._settings.textAlign?r+=e.innerWidth-s[h]:"center"===this._settings.textAlign&&(r+=(e.innerWidth-s[h])/2),r+=e.paddingLeft,d.push({text:o[h],x:r,y:i,w:s[h]});if(this._settings.highlight){var c=this._settings.highlightColor,p=this._settings.highlightHeight*n||1.5*e.fontSize,f=this._settings.highlightOffset*n,v=null!==this._settings.highlightPaddingLeft?this._settings.highlightPaddingLeft*n:e.paddingLeft,g=null!==this._settings.highlightPaddingRight?this._settings.highlightPaddingRight*n:e.paddingRight;this._context.fillStyle=a(c);for(var m=0;m<d.length;m++){var x=d[m];this._context.fillRect(x.x-v,x.y-e.offsetY+f,x.w+g+v,p)}}var y=null;this._settings.shadow&&(y=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=a(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*n,this._context.shadowOffsetY=this._settings.shadowOffsetY*n,this._context.shadowBlur=this._settings.shadowBlur*n),this._context.fillStyle=a(this._settings.textColor);for(var w=0,b=d.length;w<b;w++){var _=d[w];if(0===e.letterSpacing)this._context.fillText(_.text,_.x,_.y);else for(var T=_.text.split(""),S=_.x,C=0,R=T.length;C<R;C++)this._context.fillText(T[C],S,_.y),S+=this.measureText(T[C],e.letterSpacing)}y&&(this._context.shadowColor=y[0],this._context.shadowOffsetX=y[1],this._context.shadowOffsetY=y[2],this._context.shadowBlur=y[3]),(e.cutSx||e.cutSy)&&this._context.translate(e.cutSx,e.cutSy),this.renderInfo=e}wrapWord(e,t,r){var i=this._context.measureText(r).width,n=e.length,o=this._context.measureText(e).width;if(o<=t)return e;var s=Math.floor(t*n/o),a=this._context.measureText(e.substring(0,s)).width+i;if(a>t)for(;s>0&&(a=this._context.measureText(e.substring(0,s)).width+i)>t;)s-=1;else for(;s<n;){if(!((a=this._context.measureText(e.substring(0,s)).width+i)<t)){s-=1;break}s+=1}return e.substring(0,s)+(t>=i?r:"")}wrapText(e,t,r,i=0){for(var n=e.split(/\r?\n/g),o=[],s=[],a=0;a<n.length;a++){for(var l=[],d="",h=t-i,u=n[a].split(" "),c=0;c<u.length;c++){var p=this.measureText(u[c],r),f=p+this.measureText(" ",r);0===c||f>h?(c>0&&(l.push(d),d=""),d+=u[c],h=t-p-(0===c?i:0)):(h-=f,d+=` ${u[c]}`)}l.push(d),d="",o=o.concat(l),a<n.length-1&&s.push(o.length)}return{l:o,n:s}}measureText(e,t=0){return t?e.split("").reduce(((e,r)=>e+this._context.measureText(r).width+t),0):this._context.measureText(e).width}mergeDefaults(e){return l({text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,overflowSuffix:"...",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0},e)}}var Z="undefined"==typeof self?globalThis:self,J=(null===(U=Z.document)||void 0===U?void 0:U.fonts)||Z.fonts;var ee=p(0,0,0,0);class te extends V{constructor(e){super(e),d(this,"canvas",void 0),d(this,"context",void 0),d(this,"rendererBounds",void 0),"undefined"!=typeof OffscreenCanvas?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");var t=this.canvas.getContext("2d");t||(this.canvas=document.createElement("canvas"),t=this.canvas.getContext("2d")),h(t),this.context=t,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,t)=>{e.props.fontFamily=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontWeight:(e,t)=>{e.props.fontWeight=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStyle:(e,t)=>{e.props.fontStyle=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontStretch:(e,t)=>{e.props.fontStretch=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},fontSize:(e,t)=>{e.props.fontSize=t,e.fontInfo=void 0,this.invalidateLayoutCache(e)},text:(e,t)=>{e.props.text=t,this.invalidateLayoutCache(e)},textAlign:(e,t)=>{e.props.textAlign=t,this.invalidateLayoutCache(e)},color:(e,t)=>{e.props.color=t,this.invalidateLayoutCache(e)},x:(e,t)=>{e.props.x=t,this.invalidateVisibleWindowCache(e)},y:(e,t)=>{e.props.y=t,this.invalidateVisibleWindowCache(e)},contain:(e,t)=>{e.props.contain=t,this.invalidateLayoutCache(e)},width:(e,t)=>{e.props.width=t,"none"!==e.props.contain&&this.invalidateLayoutCache(e)},height:(e,t)=>{e.props.height=t,"both"===e.props.contain&&this.invalidateLayoutCache(e)},offsetY:(e,t)=>{e.props.offsetY=t,this.invalidateLayoutCache(e)},scrollY:(e,t)=>{e.props.scrollY=t},letterSpacing:(e,t)=>{e.props.letterSpacing=t,this.invalidateLayoutCache(e)},lineHeight:(e,t)=>{e.props.lineHeight=t,this.invalidateLayoutCache(e)},maxLines:(e,t)=>{e.props.maxLines=t,this.invalidateLayoutCache(e)},textBaseline:(e,t)=>{e.props.textBaseline=t,this.invalidateLayoutCache(e)},verticalAlign:(e,t)=>{e.props.verticalAlign=t,this.invalidateLayoutCache(e)},overflowSuffix:(e,t)=>{e.props.overflowSuffix=t,this.invalidateLayoutCache(e)}}}canRenderFont(e){return!0}isFontFaceSupported(e){return e instanceof K}addFontFace(e){h(e instanceof K),J.add(e.fontFace)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new u,canvasPages:void 0,lightning2TextRenderer:new Q(this.canvas,this.context),renderWindow:void 0,visibleWindow:{x1:0,y1:0,x2:0,y2:0,valid:!1},renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,fontFaceLoadedHandler:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(e){if("initialState"===e.status&&this.setStatus(e,"loading"),!e.fontInfo){var t=(r=e.props,i=r.fontFamily,[r.fontStyle,r.fontWeight,r.fontStretch,`${r.fontSize}px`,i].join(" "));if(e.fontInfo={cssString:t,loaded:!1},!e.fontInfo.loaded)return void J.load(t).then(this.onFontLoaded.bind(this,e,t)).catch(this.onFontLoadError.bind(this,e,t))}var r,i;if(e.fontInfo.loaded){if(!e.renderInfo){var o=e.props.maxLines,s="both"===e.props.contain?Math.floor((e.props.height-e.props.offsetY)/e.props.lineHeight):0,a=s>0&&o>0?Math.min(s,o):Math.max(s,o);e.lightning2TextRenderer.settings={text:e.props.text,textAlign:e.props.textAlign,fontFace:e.props.fontFamily,fontSize:e.props.fontSize,fontStyle:[e.props.fontStretch,e.props.fontStyle,e.props.fontWeight].join(" "),textColor:c(e.props.color),offsetY:e.props.fontSize+e.props.offsetY,wordWrap:"none"!==e.props.contain,wordWrapWidth:"none"===e.props.contain?void 0:e.props.width,letterSpacing:e.props.letterSpacing,lineHeight:e.props.lineHeight,maxLines:a,textBaseline:e.props.textBaseline,verticalAlign:e.props.verticalAlign,overflowSuffix:e.props.overflowSuffix},e.renderInfo=e.lightning2TextRenderer.calculateRenderInfo(),e.textH=e.renderInfo.lineHeight*e.renderInfo.lines.length,e.textW=e.renderInfo.width,e.renderWindow=void 0}var l=e.props,d=l.x,h=l.y,u=l.width,v=l.height,g=l.scrollY,m=l.contain,x=e.visibleWindow,y=e.renderWindow,w=e.canvasPages;if(!x.valid){var b=p(d,h,"none"!==m?d+u:1/0,"both"===m?h+v:1/0,ee);f(this.rendererBounds,b,x),x.valid=!0}var _=x.y2-x.y1,T=Math.ceil(_/e.renderInfo.lineHeight);if(0===_)return w=void 0,y=void 0,void this.setStatus(e,"loaded");if(y&&w){var S=d+y.x1,C=h-g+y.y1,R=d+y.x2,I=h-g+y.y2;if(S<=x.x1&&R>=x.x2&&C<=x.y1&&I>=x.y2)return void this.setStatus(e,"loaded");I<x.y2?(y.y1+=T*e.renderInfo.lineHeight,y.y2+=T*e.renderInfo.lineHeight,w.push(w.shift()),w[2].lineNumStart=w[1].lineNumStart+T,w[2].lineNumEnd=w[2].lineNumStart+T,w[2].valid=!1):C>x.y1&&(y.y1-=T*e.renderInfo.lineHeight,y.y2-=T*e.renderInfo.lineHeight,w.unshift(w.pop()),w[0].lineNumStart=w[1].lineNumStart-T,w[0].lineNumEnd=w[0].lineNumStart+T,w[0].valid=!1)}else{var N,L,M,k=e.renderInfo.lineHeight*T,B=Math.ceil(g/k),F=B*T,E=F-T,A=F+T;w=[{texture:null===(N=w)||void 0===N?void 0:N[0].texture,lineNumStart:E,lineNumEnd:E+T,valid:!1},{texture:null===(L=w)||void 0===L?void 0:L[1].texture,lineNumStart:F,lineNumEnd:F+T,valid:!1},{texture:null===(M=w)||void 0===M?void 0:M[2].texture,lineNumStart:A,lineNumEnd:A+T,valid:!1}],e.canvasPages=w;var z=B*k;y={x1:0,y1:z-k,x2:u,y2:z+2*k}}e.renderWindow=y,performance.now();var P,O=n(w);try{for(O.s();!(P=O.n()).done;){var $=P.value;if(!$.valid)if($.lineNumStart<0){var D;null===(D=$.texture)||void 0===D||D.setRenderableOwner(e,!1),$.texture=this.stage.txManager.loadTexture("ImageTexture",{src:""}),$.texture.setRenderableOwner(e,e.isRenderable),$.valid=!0}else{var Y;if(e.lightning2TextRenderer.draw(e.renderInfo,{lines:e.renderInfo.lines.slice($.lineNumStart,$.lineNumEnd),lineWidths:e.renderInfo.lineWidths.slice($.lineNumStart,$.lineNumEnd)}),0!==this.canvas.width&&0!==this.canvas.height)null===(Y=$.texture)||void 0===Y||Y.setRenderableOwner(e,!1),$.texture=this.stage.txManager.loadTexture("ImageTexture",{src:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)},{preload:!0}),$.texture.setRenderableOwner(e,e.isRenderable);$.valid=!0}}}catch(U){O.e(U)}finally{O.f()}this.setStatus(e,"loaded")}}renderQuads(e,t,r,i){var n=this.stage,o=e.canvasPages,s=e.textW,a=void 0===s?0:s,l=e.textH,d=void 0===l?0:l,u=e.renderWindow;if(o&&u){var c=e.props,p=c.x,f=c.y,x=c.scrollY,y=c.contain,w=c.width,b=c.height,_={x:p,y:f,width:"none"!==y?w:a,height:"both"===y?b:d};v({x:0,y:0,width:n.options.appWidth,height:n.options.appHeight},_),h(o,"canvasPages is not defined"),h(u,"renderWindow is not defined");var T,S,C,R,I,N,L=(u.y2-u.y1)/3,M=e.props,k=M.zIndex,B=M.color,F=i*g(B),E=m(4294967295,F);if(o[0].valid)this.stage.renderer.addQuad({alpha:F,clippingRect:r,colorBl:E,colorBr:E,colorTl:E,colorTr:E,width:(null===(T=o[0].texture)||void 0===T||null===(T=T.dimensions)||void 0===T?void 0:T.width)||0,height:(null===(S=o[0].texture)||void 0===S||null===(S=S.dimensions)||void 0===S?void 0:S.height)||0,texture:o[0].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:k,tx:t.tx,ty:t.ty-x+u.y1,ta:t.ta,tb:t.tb,tc:t.tc,td:t.td});if(o[1].valid)this.stage.renderer.addQuad({alpha:F,clippingRect:r,colorBl:E,colorBr:E,colorTl:E,colorTr:E,width:(null===(C=o[1].texture)||void 0===C||null===(C=C.dimensions)||void 0===C?void 0:C.width)||0,height:(null===(R=o[1].texture)||void 0===R||null===(R=R.dimensions)||void 0===R?void 0:R.height)||0,texture:o[1].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:k,tx:t.tx,ty:t.ty-x+u.y1+L,ta:t.ta,tb:t.tb,tc:t.tc,td:t.td});if(o[2].valid)this.stage.renderer.addQuad({alpha:F,clippingRect:r,colorBl:E,colorBr:E,colorTl:E,colorTr:E,width:(null===(I=o[2].texture)||void 0===I||null===(I=I.dimensions)||void 0===I?void 0:I.width)||0,height:(null===(N=o[2].texture)||void 0===N||null===(N=N.dimensions)||void 0===N?void 0:N.height)||0,texture:o[2].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:k,tx:t.tx,ty:t.ty-x+u.y1+L+L,ta:t.ta,tb:t.tb,tc:t.tc,td:t.td})}}setIsRenderable(e,t){var r;super.setIsRenderable(e,t),null===(r=e.canvasPages)||void 0===r||r.forEach((r=>{var i;null===(i=r.texture)||void 0===i||i.setRenderableOwner(e,t)}))}destroyState(e){var t;null===(t=e.canvasPages)||void 0===t||t.forEach((t=>{var r;null===(r=t.texture)||void 0===r||r.setRenderableOwner(e,!1)}))}invalidateVisibleWindowCache(e){e.visibleWindow.valid=!1,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}invalidateLayoutCache(e){e.renderInfo=void 0,e.visibleWindow.valid=!1,this.setStatus(e,"loading"),this.scheduleUpdateState(e)}onFontLoaded(e,t){var r;t===(null===(r=e.fontInfo)||void 0===r?void 0:r.cssString)&&e.fontInfo&&(e.fontInfo.loaded=!0,this.scheduleUpdateState(e))}onFontLoadError(e,t,r){var i;t===(null===(i=e.fontInfo)||void 0===i?void 0:i.cssString)&&e.fontInfo&&(e.fontInfo.loaded=!0,console.error(`CanvasTextRenderer: Error loading font '${e.fontInfo.cssString}'`,r),this.scheduleUpdateState(e))}}class re extends x{constructor(e){super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(e){var t=this.glw;t.activeTexture(0),t.bindTexture(e[0].ctxTexture)}}d(re,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio;\n        vec2 screenSpace = vec2(2.0 / u_resolution.x, -2.0 / u_resolution.y);\n\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        gl_Position = vec4(normalized.x * screenSpace.x - 1.0, normalized.y * -abs(screenSpace.y) + 1.0, 0.0, 1.0);\n        gl_Position.y = -sign(screenSpace.y) * gl_Position.y;\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n          vec4 color = texture2D(u_texture, v_textureCoordinate);\n          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);\n      }\n    "});class ie extends x{constructor(e){super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]}),d(this,"supportsIndexedTextures",!0)}bindTextures(e){var t=this.renderer,r=this.glw;if(e.length>t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error(`DefaultShaderBatched: Cannot bind more than ${t.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS} textures`);e.forEach(((e,t)=>{r.activeTexture(t),r.bindTexture(e.ctxTexture)}));var i=Array.from(Array(e.length).keys());this.setUniform("u_textures[0]",i)}}function ne(e,t){var r,i,n=0;function o(){var o,s,a=r,l=arguments.length;e:for(;a;){if(a.args.length===arguments.length){for(s=0;s<l;s++)if(a.args[s]!==arguments[s]){a=a.next;continue e}return a!==r&&(a===i&&(i=a.prev),a.prev.next=a.next,a.next&&(a.next.prev=a.prev),a.next=r,a.prev=null,r.prev=a,r=a),a.val}a=a.next}for(o=new Array(l),s=0;s<l;s++)o[s]=arguments[s];return a={args:o,val:e.apply(null,o)},r?(r.prev=a,a.next=r):i=a,n===t.maxSize?(i=i.prev).next=null:n++,r=a,a.val}return t=t||{},o.clear=function(){r=null,i=null,n=0},o}d(ie,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      void main(){\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_textureIndex = a_textureIndex;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:e=>`\n      #define txUnits ${e}\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textures[txUnits];\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      vec4 sampleFromTexture(sampler2D textures[${e}], int idx, vec2 uv) {\n        ${Array.from(Array(e).keys()).map((e=>`\n          ${0!==e?"else ":""}if (idx == ${e}) {\n            return texture2D(textures[${e}], uv);\n          }\n        `)).join("")}\n        return texture2D(textures[0], uv);\n      }\n\n      void main(){\n        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);\n      }\n    `});var oe=new Map,se=(e,t)=>{var r=JSON.stringify(e);if(oe.has(r))return oe.get(r);var i=(null!=e?e:[]).map((e=>({type:e.type,props:t[e.type].resolveDefaults(e.props||{})})));return oe.set(r,i),i};class ae extends x{constructor(e,t,r){var i=ae.createShader(t,r);super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...i.uniforms],shaderSources:{vertex:i.vertex,fragment:i.fragment}}),d(this,"effects",[]),this.effects=i.effects,this.calculateProps=ne(this.calculateProps.bind(this))}bindTextures(e){var t=this.glw;t.activeTexture(0),t.bindTexture(e[0].ctxTexture)}calculateProps(e){var t=this.renderer.shManager.getRegisteredEffects(),r=[];return null==e||e.forEach(((e,i)=>{var n,o=this.effects[i],s=t[o.name],a=null!==(n=e.props)&&void 0!==n?n:{},l=o.uniformInfo;Object.keys(a).forEach((e=>{var t=s.uniforms[e],i=l[e],n=t.validator?t.validator(a[e],a):a[e];Array.isArray(n)&&(n=new Float32Array(n)),r.push({name:i.name,value:n})}))})),r}bindProps(e){this.calculateProps(e.effects).forEach((e=>{this.setUniform(e.name,e.value)}))}canBatchShaderProps(e,t){if(e.$dimensions.width!==t.$dimensions.width||e.$dimensions.height!==t.$dimensions.height||e.effects.length!==t.effects.length)return!1;for(var r=e.effects.length,i=0;i<r;i++){var n=e.effects[i],o=t.effects[i];if(n.type!==o.type)return!1;for(var s in n.props)if(o.props&&!o.props[s]||n.props[s]!==o.props[s])return!1}return!0}static createShader(e,t){var r={},i={},n="",o=[],s=[],a=e.effects.map((e=>{var i=t[e.type],a=i.getEffectKey(e.props||{});r[a]=r[a]?++r[a]:1;var l=r[a];1===l&&s.push({key:a,type:e.type,props:e.props});var d=new i({ref:`${a}${1===l?"":l}`,target:a,props:e.props});return n+=d.declaredUniforms,o.push(...Object.values(d.uniformInfo)),d})),l="";null==s||s.forEach((e=>{var r,n=t[e.type],o=n.resolveDefaults(null!==(r=e.props)&&void 0!==r?r:{}),s=[];for(var a in n.methods){var d=a,h=n.methods[a];i[a]&&i[a]!==h&&(d=ae.resolveMethodDuplicate(a,h,i)),i[d]=h.replace("function",d),s.push({m:a,cm:d})}var u=n.onShaderMask instanceof Function?n.onShaderMask(o):n.onShaderMask,c=n.onColorize instanceof Function?n.onColorize(o):n.onColorize,p=n.onEffectMask instanceof Function?n.onEffectMask(o):n.onEffectMask;s.forEach((e=>{var t=e.m,r=e.cm,i=new RegExp(`\\$${t}`,"g");u&&(u=u.replace(i,r)),c&&(c=c.replace(i,r)),p&&(p=p.replace(i,r))}));var f=n.getMethodParameters(n.uniforms,o),v=f.length>0?`, ${f}`:"";u&&(l+=`\n        float fx_${e.key}_onShaderMask(float shaderMask ${v}) {\n          ${u}\n        }\n        `),c&&(l+=`\n          vec4 fx_${e.key}_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor${v}) {\n            ${c}\n          }\n        `),p&&(l+=`\n          vec4 fx_${e.key}_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor${v}) {\n            ${p}\n          }\n        `)}));var d="";for(var h in i)d+=i[h];for(var u="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",c="\n\n    ",p=0;p<a.length;p++){var f=a[p],v=f.passParameters.length>0?`, ${f.passParameters}`:"",g=t[f.name];g.onShaderMask&&(c+=`\n        shaderMask = fx_${f.target}_onShaderMask(shaderMask ${v});\n        `),g.onColorize&&(c+=`\n        maskColor = fx_${f.target}_onColorize(shaderMask, maskColor, shaderColor${v});\n        `),g.onEffectMask&&(u=`fx_${f.target}_onEffectMask(shaderMask, maskColor, shaderColor${v})`);var m=a[p+1];(void 0===m||t[m.name].onEffectMask)&&(c+=`\n          shaderColor = ${u};\n        `)}return{effects:a,uniforms:o,fragment:ae.fragment(n,d,l,c),vertex:ae.vertex()}}static resolveMethodDuplicate(e,t,r,i=0){var n=e+(i>0?i:"");return r[n]&&r[n]!==t?this.resolveMethodDuplicate(e,t,r,++i):n}static resolveDefaults(e,t){return{effects:se(e.effects,t),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(e,t){var r,i="";return null===(r=e.effects)||void 0===r||r.forEach((e=>{var r=t[e.type].getEffectKey(e.props||{});i+=`,${r}`})),`DynamicShader${i}`}}d(ae,"z$__type__Props",void 0),d(ae,"vertex",(()=>"\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    attribute vec2 a_textureCoordinate;\n    attribute vec2 a_position;\n    attribute vec4 a_color;\n    attribute float a_textureIndex;\n\n    uniform vec2 u_resolution;\n    uniform float u_pixelRatio;\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying float v_textureIndex;\n\n    void main(){\n      vec2 normalized = a_position * u_pixelRatio / u_resolution;\n      vec2 zero_two = normalized * 2.0;\n      vec2 clip_space = zero_two - 1.0;\n\n      // pass to fragment\n      v_color = a_color;\n      v_textureCoordinate = a_textureCoordinate;\n      v_textureIndex = a_textureIndex;\n\n      // flip y\n      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n    }\n  ")),d(ae,"fragment",((e,t,r,i)=>`\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    #define PI 3.14159265359\n\n    uniform vec2 u_resolution;\n    uniform vec2 u_dimensions;\n    uniform float u_alpha;\n    uniform float u_radius;\n    uniform sampler2D u_texture;\n    uniform float u_pixelRatio;\n\n    ${e}\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n\n    ${t}\n\n    ${r}\n\n    void main() {\n      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;\n      vec2 d = abs(p) - (u_dimensions) * 0.5;\n      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n\n      vec4 shaderColor = vec4(0.0);\n      float shaderMask = lng_DefaultMask;\n\n      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;\n\n      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));\n\n      ${i}\n\n      gl_FragColor = shaderColor * u_alpha;\n    }\n  `));class le extends x{constructor(e){super({renderer:e,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(e){return{radius:e.radius||10,$dimensions:{width:0,height:0}}}bindTextures(e){var t=this.glw;t.activeTexture(0),t.bindTexture(e[0].ctxTexture)}bindProps(e){this.setUniform("u_radius",e.radius)}canBatchShaderProps(e,t){return e.radius===t.radius&&e.$dimensions.width===t.$dimensions.width&&e.$dimensions.height===t.$dimensions.height}}d(le,"z$__type__Props",void 0),d(le,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform vec2 u_dimensions;\n      uniform float u_radius;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      float boxDist(vec2 p, vec2 size, float radius){\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n\n      float fillMask(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n\n      void main() {\n        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;\n        vec2 halfDimensions = u_dimensions * 0.5;\n\n        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);\n        gl_FragColor = mix(vec4(0.0), color, fillMask(d));\n      }\n    "});var de=new Float32Array([1,0,0,0,1,0,0,0,1]);class he extends x{constructor(e){super({renderer:e,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(e){var t=this.glw;t.activeTexture(0),t.bindTexture(e[0].ctxTexture)}bindProps(e){var t=he.resolveDefaults(e);for(var r in t)if("transform"===r)this.setUniform("u_transform",!1,t[r]);else if("scrollY"===r)this.setUniform("u_scrollY",t[r]);else if("color"===r){var i=c(t.color);this.setUniform("u_color",i)}else"size"===r?this.setUniform("u_size",t[r]):"distanceRange"===r?this.setUniform("u_distanceRange",t[r]):"debug"===r&&this.setUniform("u_debug",t[r]?1:0)}static resolveDefaults(e={}){var t,r,i,n,o,s;return{transform:null!==(t=e.transform)&&void 0!==t?t:de,scrollY:null!==(r=e.scrollY)&&void 0!==r?r:0,color:null!==(i=e.color)&&void 0!==i?i:4294967295,size:null!==(n=e.size)&&void 0!==n?n:16,distanceRange:null!==(o=e.distanceRange)&&void 0!==o?o:1,debug:null!==(s=e.debug)&&void 0!==s&&s}}}d(he,"shaderSources",{vertex:"\n      // an attribute is an input (in) to a vertex shader.\n      // It will receive data from a buffer\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform mat3 u_transform;\n      uniform float u_scrollY;\n      uniform float u_pixelRatio;\n      uniform float u_size;\n\n      varying vec2 v_texcoord;\n\n      void main() {\n        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);\n        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;\n\n        // Calculate screen space with pixel ratio\n        vec2 screenSpace = (transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1);\n\n        gl_Position = vec4(screenSpace, 0.0, 1.0);\n        v_texcoord = a_textureCoordinate;\n\n      }\n    ",fragment:"\n      precision highp float;\n\n      uniform vec4 u_color;\n      uniform sampler2D u_texture;\n      uniform float u_distanceRange;\n      uniform float u_pixelRatio;\n      uniform int u_debug;\n\n      varying vec2 v_texcoord;\n\n      float median(float r, float g, float b) {\n          return max(min(r, g), min(max(r, g), b));\n      }\n\n      void main() {\n          vec3 sample = texture2D(u_texture, v_texcoord).rgb;\n          if (u_debug == 1) {\n            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);\n            return;\n          }\n          float scaledDistRange = u_distanceRange * u_pixelRatio;\n          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);\n          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;\n\n          // Build the final color.\n          // IMPORTANT: We must premultiply the color by the alpha value before returning it.\n          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);\n      }\n    "});class ue extends j{constructor(...e){super(...e),d(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(e){var t;return{radius:null!==(t=e.radius)&&void 0!==t?t:10}}}d(ue,"z$__type__Props",void 0),d(ue,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",validator:e=>{var t=e;return Array.isArray(t)?2===t.length?t=[t[0],t[1],t[0],t[1]]:3===t.length?t=[t[0],t[1],t[2],t[0]]:4!==t.length&&(t=[t[0],t[0],t[0],t[0]]):"number"==typeof t&&(t=[t,t,t,t]),t}}}),d(ue,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),d(ue,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);\n  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);\n  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);\n  "),d(ue,"onEffectMask","\n  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));\n  ");class ce extends j{constructor(...e){super(...e),d(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(e){var t,r;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(r=e.color)&&void 0!==r?r:4294967295}}}d(ce,"z$__type__Props",void 0),d(ce,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>c(e),method:"uniform4fv",type:"vec4"}}),d(ce,"onEffectMask","\n  float mask = clamp(shaderMask + width, 0.0, 1.0) - clamp(shaderMask, 0.0, 1.0);\n  return mix(shaderColor, mix(shaderColor, maskColor, maskColor.a), mask);\n  "),d(ce,"onColorize","\n    return color;\n  ");class pe extends j{constructor(...e){super(...e),d(this,"name","linearGradient")}static getEffectKey(e){return`linearGradient${e.colors.length}`}static resolveDefaults(e){var t,r,i=null!==(t=e.colors)&&void 0!==t?t:[4278190080,4294967295],n=e.stops||[];if(0===n.length||n.length!==i.length){for(var o=i.length,s=0,a=n;s<o;s++)n[s]?(a[s]=n[s],void 0===n[s-1]&&void 0!==a[s-2]&&(a[s-1]=a[s-2]+(n[s]-a[s-2])/2)):a[s]=s*(1/(i.length-1));n=a}return{colors:i,stops:n,angle:null!==(r=e.angle)&&void 0!==r?r:0}}}W=pe,d(pe,"z$__type__Props",void 0),d(pe,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:e=>e.map((e=>c(e))).reduce(((e,t)=>e.concat(t)),[]),size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),d(pe,"methods",{fromLinear:"\n      vec4 function(vec4 linearRGB) {\n        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);\n        vec4 lower = linearRGB * vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",toLinear:"\n      vec4 function(vec4 sRGB) {\n        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));\n        vec4 lower = sRGB/vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",calcPoint:"\n      vec2 function(float d, float angle) {\n        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);\n      }\n    "}),d(pe,"ColorLoop",(e=>{for(var t="",r=2;r<e;r++)t+=`colorOut = mix(colorOut, colors[${r}], clamp((dist - stops[${r-1}]) / (stops[${r}] - stops[${r-1}]), 0.0, 1.0));`;return t})),d(pe,"onColorize",(e=>{var t=e.colors.length||1;return`\n      float a = angle - (PI / 180.0 * 90.0);\n      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));\n      vec2 f = $calcPoint(lineDist * 0.5, a);\n      vec2 t = $calcPoint(lineDist * 0.5, a + PI);\n      vec2 gradVec = t - f;\n      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));\n      ${W.ColorLoop(t)}\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    `}));class fe extends j{constructor(...e){super(...e),d(this,"name","grayscale")}static getEffectKey(){return"grayscale"}static resolveDefaults(e){var t;return{amount:null!==(t=e.amount)&&void 0!==t?t:1}}}d(fe,"uniforms",{amount:{value:1,method:"uniform1f",type:"float"}}),d(fe,"onColorize","\n    float grayness = 0.2 * maskColor.r + 0.6 * maskColor.g + 0.2 * maskColor.b;\n    return vec4(amount * vec3(grayness) + (1.0 - amount) * maskColor.rgb, maskColor.a);\n  ");class ve extends j{constructor(...e){super(...e),d(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(e){var t,r;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(r=e.color)&&void 0!==r?r:4294967295}}}d(ve,"z$__type__Props",void 0),d(ve,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>c(e),method:"uniform4fv",type:"vec4"}}),d(ve,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),d(ve,"onEffectMask","\n  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),d(ve,"onColorize","\n    return color;\n  ");class ge extends j{constructor(...e){super(...e),d(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(e){var t,r;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(r=e.color)&&void 0!==r?r:4294967295}}}d(ge,"z$__type__Props",void 0),d(ge,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>c(e),method:"uniform4fv",type:"vec4"}}),d(ge,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),d(ge,"onEffectMask","\n  vec2 pos = vec2(0.0, width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),d(ge,"onColorize","\n    return color;\n  ");class me extends j{constructor(...e){super(...e),d(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(e){var t,r;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(r=e.color)&&void 0!==r?r:4294967295}}}d(me,"z$__type__Props",void 0),d(me,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>c(e),method:"uniform4fv",type:"vec4"}}),d(me,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),d(me,"onEffectMask","\n  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),d(me,"onColorize","\n    return color;\n  ");class xe extends j{constructor(...e){super(...e),d(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(e){var t,r;return{width:null!==(t=e.width)&&void 0!==t?t:10,color:null!==(r=e.color)&&void 0!==r?r:4294967295}}}d(xe,"z$__type__Props",void 0),d(xe,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>c(e),method:"uniform4fv",type:"vec4"}}),d(xe,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),d(xe,"onEffectMask","\n  vec2 pos = vec2(width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),d(xe,"onColorize","\n    return color;\n  ");class ye extends j{constructor(...e){super(...e),d(this,"name","glitch")}static getEffectKey(e){return"glitch"}static resolveDefaults(e){var t,r,i,n,o;return{amplitude:null!==(t=e.amplitude)&&void 0!==t?t:.2,narrowness:null!==(r=e.narrowness)&&void 0!==r?r:4,blockiness:null!==(i=e.blockiness)&&void 0!==i?i:2,minimizer:null!==(n=e.minimizer)&&void 0!==n?n:8,time:null!==(o=e.time)&&void 0!==o?o:Date.now()}}}d(ye,"z$__type__Props",void 0),d(ye,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",validator:e=>(Date.now()-e)%1e3,type:"float"}}),d(ye,"methods",{rand:"\n      float function(vec2 p, float time) {\n        float t = floor(time * 20.) / 10.;\n        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);\n      }\n    ",noise:"\n      float function(vec2 uv, float blockiness, float time) {\n        vec2 lv = fract(uv);\n        vec2 id = floor(uv);\n\n        float n1 = rand(id, time);\n        float n2 = rand(id+vec2(1,0), time);\n        float n3 = rand(id+vec2(0,1), time);\n        float n4 = rand(id+vec2(1,1), time);\n        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);\n        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);\n      }\n    ",fbm:"\n      float function(vec2 uv, int count, float blockiness, float complexity, float time) {\n        float val = 0.0;\n        float amp = 0.5;\n        const int MAX_ITERATIONS = 10;\n\n        for(int i = 0; i < MAX_ITERATIONS; i++) {\n          if(i >= count) {break;}\n          val += amp * noise(uv, blockiness, time);\n          amp *= 0.5;\n          uv *= complexity;\n        }\n        return val;\n      }\n    "}),d(ye,"onColorize","\n    vec2 uv = v_textureCoordinate.xy;\n    float aspect = u_dimensions.x / u_dimensions.y;\n    vec2 a = vec2(uv.x * aspect , uv.y);\n    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));\n\n    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);\n    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);\n    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);\n    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);\n\n    vec3 f = vec3(colR, colG, colB);\n    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);\n  ");class we extends j{constructor(...e){super(...e),d(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(e){var t;return{fade:null!==(t=e.fade)&&void 0!==t?t:10}}}d(we,"z$__type__Props",void 0),d(we,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:e=>{var t=e;return Array.isArray(t)?2===t.length?t=[t[0],t[1],t[0],t[1]]:3===t.length?t=[t[0],t[1],t[2],t[0]]:4!==t.length&&(t=[t[0],t[0],t[0],t[0]]):"number"==typeof t&&(t=[t,t,t,t]),t}}}),d(we,"onColorize","\n  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;\n  vec2 pos1;\n  vec2 pos2;\n  vec2 d;\n  float c;\n  vec4 result = maskColor;\n\n\n  if(fade[0] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x, point.y + fade[0]);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[1] > 0.0) {\n    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);\n    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[2] > 0.0) {\n    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);\n    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[3] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x + fade[3], point.y);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  return result;\n  ");class be extends j{constructor(...e){super(...e),d(this,"name","radialGradient")}static getEffectKey(e){return`radialGradient${e.colors.length}`}static resolveDefaults(e){var t,r,i,n,o,s=null!==(t=e.colors)&&void 0!==t?t:[4278190080,4294967295],a=e.stops||[];if(0===a.length||a.length!==s.length){for(var l=s.length,d=0,h=a;d<l;d++)a[d]?(h[d]=a[d],void 0===a[d-1]&&void 0!==h[d-2]&&(h[d-1]=h[d-2]+(a[d]-h[d-2])/2)):h[d]=d*(1/(s.length-1));a=h}return{colors:s,stops:a,width:null!==(r=e.width)&&void 0!==r?r:0,height:null!==(i=null!==(n=e.height)&&void 0!==n?n:e.width)&&void 0!==i?i:0,pivot:null!==(o=e.pivot)&&void 0!==o?o:[.5,.5]}}}H=be,d(be,"z$__type__Props",void 0),d(be,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:e=>e.map((e=>c(e))).reduce(((e,t)=>e.concat(t)),[]),size:e=>e.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],size:e=>e.colors.length,method:"uniform1fv",type:"float"}}),d(be,"ColorLoop",(e=>{for(var t="",r=2;r<e;r++)t+=`colorOut = mix(colorOut, colors[${r}], clamp((dist - stops[${r-1}]) / (stops[${r}] - stops[${r-1}]), 0.0, 1.0));`;return t})),d(be,"onColorize",(e=>{var t=e.colors.length||1;return`\n      vec2 point = v_textureCoordinate.xy * u_dimensions;\n      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);\n\n      float dist = length((point - projection) / vec2(width, height));\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = mix(colors[0], colors[1], stopCalc);\n      ${H.ColorLoop(t)}\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    `}));class _e extends j{constructor(...e){super(...e),d(this,"name","radialProgress")}static getEffectKey(){return"radialProgress"}static resolveDefaults(e){var t,r,i,n,o,s,a;return{width:null!==(t=e.width)&&void 0!==t?t:10,progress:null!==(r=e.progress)&&void 0!==r?r:.5,offset:null!==(i=e.offset)&&void 0!==i?i:0,range:null!==(n=e.range)&&void 0!==n?n:2*Math.PI,rounded:null!==(o=e.rounded)&&void 0!==o&&o,radius:null!==(s=e.radius)&&void 0!==s?s:1,color:null!==(a=e.color)&&void 0!==a?a:4294967295}}}d(_e,"z$__type__Props",void 0),d(_e,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},progress:{value:.5,method:"uniform1f",type:"float"},offset:{value:0,method:"uniform1f",type:"float"},range:{value:0,method:"uniform1f",type:"float"},rounded:{value:0,method:"uniform1f",type:"float",validator:e=>e?1:0},radius:{value:1,method:"uniform1f",type:"float"},color:{value:4294967295,validator:e=>c(e),method:"uniform4fv",type:"vec4"}}),d(_e,"methods",{rotateUV:"\n    vec2 function(vec2 uv, float d) {\n      float s = sin(d);\n      float c = cos(d);\n      mat2 rotMatrix = mat2(c, -s, s, c);\n      return uv * rotMatrix;\n    }\n    ",drawDot:"\n    float function(vec2 uv, vec2 p, float r) {\n      uv += p;\n      float circle = length(uv) - r;\n      return clamp(-circle, 0.0, 1.0);\n    }\n    "}),d(_e,"onEffectMask","\n    float outerRadius = radius * u_dimensions.y * 0.5;\n\n    float endAngle = range * progress - 0.0005;\n\n    vec2 uv = v_textureCoordinate.xy * u_dimensions.xy - u_dimensions * 0.5;\n\n    uv = $rotateUV(uv, -(offset));\n    float linewidth = width * u_pixelRatio;\n    float circle = length(uv) - (outerRadius - linewidth) ;\n    circle = abs(circle) - linewidth;\n    circle = clamp(-circle, 0.0, 1.0);\n\n    float angle = (atan(uv.x, -uv.y) / 3.14159265359 * 0.5);\n    float p = endAngle / (PI * 2.);\n\n    circle *= step(fract(angle), fract(p));\n\n    circle = rounded < 1. ? circle : max(circle, $drawDot(uv, vec2(0, outerRadius - linewidth), linewidth));\n    circle = rounded < 1. ? circle : max(circle, $drawDot($rotateUV(uv, -(endAngle)), vec2(0, outerRadius - linewidth), linewidth));\n\n    return mix(shaderColor, maskColor, circle);\n  "),d(_e,"onColorize","\n    return color;\n  ");class Te extends j{constructor(...e){super(...e),d(this,"name","holePunch")}static getEffectKey(){return"holePunch"}static resolveDefaults(e){var t;return{x:e.x||0,y:e.y||0,width:e.width||50,height:e.height||50,radius:null!==(t=e.radius)&&void 0!==t?t:0}}}d(Te,"z$__type__Props",void 0),d(Te,"uniforms",{x:{value:0,method:"uniform1f",type:"float"},y:{value:0,method:"uniform1f",type:"float"},width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},radius:{value:0,method:"uniform4fv",type:"vec4",validator:e=>{var t=e;return Array.isArray(t)?2===t.length?t=[t[0],t[1],t[0],t[1]]:3===t.length?t=[t[0],t[1],t[2],t[0]]:4!==t.length&&(t=[t[0],t[0],t[0],t[0]]):"number"==typeof t&&(t=[t,t,t,t]),t}}}),d(Te,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),d(Te,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  vec2 size = vec2(width, height) * 0.5;\n  vec2 basePos = v_textureCoordinate.xy * u_dimensions.xy - vec2(x, y);\n  vec2 pos = basePos - size;\n  float r = radius[0] * step(pos.x, 0.5) * step(pos.y, 0.5);\n  r = r + radius[1] * step(0.5, pos.x) * step(pos.y, 0.5);\n  r = r + radius[2] * step(0.5, pos.x) * step(0.5, pos.y);\n  r = r + radius[3] * step(pos.x, 0.5) * step(0.5, pos.y);\n  return $boxDist(pos, size, r);\n  "),d(Te,"onEffectMask","\n  return mix(maskColor, vec4(0.0), $fillMask(shaderMask));\n  ");var Se="RoundedRectangle";class Ce extends y{constructor(e){super(),d(this,"shType",void 0),this.shType=e,e!==Se&&console.warn("Unsupported shader:",e)}bindRenderOp(){}bindProps(){}attach(){}detach(){}}class Re{constructor(){d(this,"shCache",new Map),d(this,"shConstructors",{}),d(this,"attachedShader",null),d(this,"effectConstructors",{}),d(this,"renderer",void 0),this.registerShaderType("DefaultShader",re),this.registerShaderType("DefaultShaderBatched",ie),this.registerShaderType("RoundedRectangle",le),this.registerShaderType("DynamicShader",ae),this.registerShaderType("SdfShader",he),this.registerEffectType("border",ce),this.registerEffectType("borderBottom",me),this.registerEffectType("borderLeft",xe),this.registerEffectType("borderRight",ve),this.registerEffectType("borderTop",ge),this.registerEffectType("fadeOut",we),this.registerEffectType("linearGradient",pe),this.registerEffectType("radialGradient",be),this.registerEffectType("grayscale",fe),this.registerEffectType("glitch",ye),this.registerEffectType("radius",ue),this.registerEffectType("radialProgress",_e),this.registerEffectType("holePunch",Te)}registerShaderType(e,t){this.shConstructors[e]=t}registerEffectType(e,t){this.effectConstructors[e]=t}getRegisteredEffects(){return this.effectConstructors}getRegisteredShaders(){return this.shConstructors}loadShader(e,t){if(!this.renderer)throw new Error("Renderer is not been defined");var r=this.shConstructors[e];if(!r)throw new Error(`Shader type "${e}" is not registered`);if("canvas"===this.renderer.mode&&r.prototype instanceof x)return{shader:new Ce(e),props:t};if("DynamicShader"===e)return this.loadDynamicShader(t);var i=r.resolveDefaults(t),n=r.makeCacheKey(i)||r.name;if(n&&this.shCache.has(n))return{shader:this.shCache.get(n),props:i};var o=new r(this.renderer,t);return n&&this.shCache.set(n,o),{shader:o,props:i}}loadDynamicShader(e){if(!this.renderer)throw new Error("Renderer is not been defined");var t=ae.resolveDefaults(e,this.effectConstructors),r=ae.makeCacheKey(t,this.effectConstructors);if(r&&this.shCache.has(r))return{shader:this.shCache.get(r),props:t};var i=new ae(this.renderer,e,this.effectConstructors);return r&&this.shCache.set(r,i),{shader:i,props:t}}useShader(e){this.attachedShader!==e&&(this.attachedShader&&this.attachedShader.detach(),e.attach(),this.attachedShader=e)}}var Ie=function(){var e=i(t().mark((function e(r){var i,n;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(r);case 2:return i=e.sent,e.next=5,i.arrayBuffer();case 5:if(n=e.sent,-1===r.indexOf(".ktx")){e.next=8;break}return e.abrupt("return",Ne(n));case 8:return e.abrupt("return",Le(n));case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Ne=function(){var e=i(t().mark((function e(r){var i,n,o,s,a,l,d;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=new DataView(r),n=16909060===i.getUint32(12),o=[],s={glInternalFormat:i.getUint32(28,n),pixelWidth:i.getUint32(36,n),pixelHeight:i.getUint32(40,n),numberOfMipmapLevels:i.getUint32(56,n),bytesOfKeyValueData:i.getUint32(60,n)},a=64,a+=s.bytesOfKeyValueData,l=0;l<s.numberOfMipmapLevels;l++)d=i.getUint32(a),a+=4,o.push(i.buffer.slice(a,d)),a+=d;return e.abrupt("return",{data:{glInternalFormat:s.glInternalFormat,mipmaps:o,width:s.pixelWidth||0,height:s.pixelHeight||0,type:"ktx"},premultiplyAlpha:!1});case 8:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Le=function(){var e=i(t().mark((function e(r){var i,n,o,s,a,l,d,h,u,c,p,f;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(i=r,n=new Int32Array(i,0,13),o=n[12]+52,s=new Uint8Array(i,o),a=[],l={pixelWidth:n[7],pixelHeight:n[6],numberOfMipmapLevels:n[11]||0},d=0,h=l.pixelWidth||0,u=l.pixelHeight||0,c=0;c<l.numberOfMipmapLevels;c++)p=(h+3>>2)*(u+3>>2)*8,f=new Uint8Array(i,s.byteOffset+d,p),a.push(f),d+=p,h>>=1,u>>=1;return e.abrupt("return",{data:{glInternalFormat:36196,mipmaps:a,width:l.pixelWidth||0,height:l.pixelHeight||0,type:"pvr"},premultiplyAlpha:!1});case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();class Me extends w{constructor(e,t){super(e),d(this,"props",void 0),this.props=Me.resolveDefaults(t)}hasAlphaChannel(e){return-1!==e.indexOf("image/png")}getTextureData(){var e=this;return i(t().mark((function r(){var i,n,o,s,a,l,d;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=e.props,n=i.src,o=i.premultiplyAlpha,n){t.next=3;break}return t.abrupt("return",{data:null});case 3:if(!(n instanceof ImageData)){t.next=5;break}return t.abrupt("return",{data:n,premultiplyAlpha:o});case 5:if(!/\.(ktx|pvr)$/.test(n)){t.next=7;break}return t.abrupt("return",Ie(n));case 7:if(!e.txManager.imageWorkerManager){t.next=13;break}return t.next=10,e.txManager.imageWorkerManager.getImage(n,o);case 10:return t.abrupt("return",t.sent);case 13:if(!e.txManager.hasCreateImageBitmap){t.next=28;break}return t.next=16,fetch(n);case 16:return s=t.sent,t.next=19,s.blob();case 19:return a=t.sent,l=null!=o?o:e.hasAlphaChannel(a.type),t.next=23,createImageBitmap(a,{premultiplyAlpha:l?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"});case 23:return t.t0=t.sent,t.t1=l,t.abrupt("return",{data:t.t0,premultiplyAlpha:t.t1});case 28:return d=new Image,"data:"!==n.substr(0,5)&&(d.crossOrigin="Anonymous"),d.src=n,t.next=33,new Promise(((e,t)=>{d.onload=()=>e(),d.onerror=()=>t(new Error("Failed to load image"))})).catch((e=>{console.error(e)}));case 33:return t.abrupt("return",{data:d,premultiplyAlpha:null==o||o});case 34:case"end":return t.stop()}}),r)})))()}static makeCacheKey(e){var t=Me.resolveDefaults(e);return!(t.src instanceof ImageData)&&`ImageTexture,${t.src},${t.premultiplyAlpha}`}static resolveDefaults(e){var t,r;return{src:null!==(t=e.src)&&void 0!==t?t:"",premultiplyAlpha:null===(r=e.premultiplyAlpha)||void 0===r||r}}}d(Me,"z$__type__Props",void 0);class ke{constructor(e,t=0){d(this,"iterator",void 0),d(this,"peekBuffer",[]),d(this,"_lastIndex",void 0),this.iterator=e,this.iterator=e,this._lastIndex=t-1,this.peekBuffer=[]}next(){var e=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return e.done?this._lastIndex=-1:this._lastIndex++,e}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];var e=this.iterator.next();return this.peekBuffer.push(e),e}get lastIndex(){return this._lastIndex}}function Be(e,r=0){var i,n;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=r;case 1:if(!(i<e.length)){t.next=10;break}if(void 0!==(n=e.codePointAt(i))){t.next=5;break}throw new Error("Invalid Unicode code point");case 5:return t.next=7,n;case 7:i+=n<=65535?1:2,t.next=1;break;case 10:case"end":return t.stop()}}),X)}function Fe(e,t,r,i,o,s,a,l,d,u,c,p,f,v,g,m,x,y,w){h(g,"Font face must be loaded"),h(g.loaded,"Font face must be loaded"),h(g.data,"Font face must be loaded"),h(g.shaper,"Font face must be loaded");for(var b,_=l/g.data.info.size,T=d/_,S=s/_,C=u/_,R=f[e],I=(null==R?void 0:R.codepointIndex)||0,N=(null==R?void 0:R.maxX)||0,L=(null==R?void 0:R.maxY)||0,M=t,k=r,B=0,F={codepointIndex:-1,bufferOffset:-1,xStart:-1},E=g.shaper,A={letterSpacing:C},z=E.shapeText(A,new ke(Be(i,I),I)),P=-1,O=[],$=a/_,D=function(e,t,r){var i,o=0,s=n(r.shapeText(t,new ke(Be(e,0),0)));try{for(s.s();!(i=s.n()).done;){var a=i.value;a.mapped&&(o+=a.xAdvance)}}catch(l){s.e(l)}finally{s.f()}return o}(y,A,E),Y=!0;Y;){for(var U=(0===w||e+1<w)&&("both"!==p||x||k+T+g.maxCharHeight<=$),W=U?S:S-D,H=0,X=k+T>=v.y1,j=k<=v.y2,G=X&&j;(b=z.next())&&!b.done;){var V=b.value;if(e===f.length)f.push({codepointIndex:V.cluster,maxY:L,maxX:N});else if(e>f.length)throw new Error("Unexpected lineCache length");if(32===V.codepoint||10===V.codepoint?-1!==F.codepointIndex&&(F.codepointIndex=-1,H=M):-1===F.codepointIndex&&(F.codepointIndex=V.cluster,F.bufferOffset=B,F.xStart=H),V.mapped){var K=M+V.xOffset+V.width;if("none"!==p&&K>=W&&-1!==F.codepointIndex&&F.xStart>0){if(U){z=E.shapeText(A,new ke(Be(i,F.codepointIndex),F.codepointIndex)),B=F.bufferOffset;break}z=E.shapeText(A,new ke(Be(y,0),0)),M=F.xStart,B=F.bufferOffset,p="none"}else{var q=M+V.xOffset,Q=k+V.yOffset;if(G){-1===P&&(P=B);var Z=g.getAtlasEntry(V.glyphId),J=Z.x/g.data.common.scaleW,ee=Z.y/g.data.common.scaleH,te=Z.width/g.data.common.scaleW,re=Z.height/g.data.common.scaleH;c[B++]=q,c[B++]=Q,c[B++]=J,c[B++]=ee,c[B++]=q+V.width,c[B++]=Q,c[B++]=J+te,c[B++]=ee,c[B++]=q,c[B++]=Q+V.height,c[B++]=J,c[B++]=ee+re,c[B++]=q+V.width,c[B++]=Q+V.height,c[B++]=J+te,c[B++]=ee+re}L=Math.max(L,Q+V.height),N=Math.max(N,q+V.width),M+=V.xAdvance}}else if(10===V.codepoint){if(U)break;z=E.shapeText(A,new ke(Be(y,0),0)),p="none"}}-1!==P&&(O.push({bufferStart:P,bufferEnd:B}),P=-1),M=0,k+=T,e++,F.codepointIndex=-1,H=0,!m&&"both"===p&&k>v.y2||b&&b.done?Y=!1:U||(Y=!1)}if("center"===o)for(var ie="none"===p?N:S,ne=0;ne<O.length;ne++)for(var oe=O[ne],se=(ie-(c[oe.bufferEnd-4]-c[oe.bufferStart]))/2,ae=oe.bufferStart;ae<oe.bufferEnd;ae+=4)c[ae]+=se;else if("right"===o)for(var le="none"===p?N:S,de=0;de<O.length;de++)for(var he=O[de],ue=le-(he.bufferEnd===he.bufferStart?0:c[he.bufferEnd-4]-c[he.bufferStart]),ce=he.bufferStart;ce<he.bufferEnd;ce+=4)c[ce]+=ue;return h(b),{bufferNumFloats:B,bufferNumQuads:B/16,layoutNumCharacters:b.done?i.length-I:b.value.cluster-I+1,fullyProcessed:!!b.done,maxX:N,maxY:L}}function Ee(e,t,r,i,n,o,s,a){var l,d,h=e.screen,u=e.sdf;if(b(s)){var c=s.x1-t,p=c+(s.x2-s.x1),f=s.y1-r+i,v=(l=f-o,d=n||1,Math.floor(l/d)*d),g=function(e,t){return Math.ceil(e/t)*t}(f+(s.y2-s.y1)+o,n||1);h.x1=c,h.y1=v,h.x2=p,h.y2=g,u.x1=c/a,u.y1=v/a,u.x2=p/a,u.y2=g/a,e.numLines=Math.ceil((g-v)/n),e.firstLineIdx=n?Math.floor(v/n):0}else h.x1=0,h.y1=0,h.x2=0,h.y2=0,u.x1=0,u.y1=0,u.x2=0,u.y2=0,e.numLines=0,e.firstLineIdx=0;e.valid=!0}var Ae={normal:400,bold:700,bolder:900,lighter:100},ze=e=>"number"==typeof e?e:Ae[e]||400;var Pe=ne((function(e,t,r,i,o){var s,a=ze(r),l=n(e);try{for(l.s();!(s=l.n()).done;){var d=s.value[t];if(d){if(1===d.size)return console.warn(`TrFontManager: Only one font face found for family: '${t}' - will be used for all weights and styles`),d.values().next().value;var h,u=new Map,c=n(d);try{for(c.s();!(h=c.n()).done;){var p=h.value,f=ze(p.descriptors.weight);if(f===a&&p.descriptors.style===i&&p.descriptors.stretch===o)return p;u.set(f,p)}}catch(g){c.e(g)}finally{c.f()}var v=`TrFontManager: No exact match: '${t} Weight: ${a} Style: ${i} Stretch: ${o}'`;if(console.error(v),400===a&&u.has(500))return u.get(500);if(500===a&&u.has(400))return u.get(400);if(a<400){for(;a>0;){if(u.has(a))return u.get(a);a-=100}a=600}for(;a<1e3;){if(u.has(a))return u.get(a);a+=100}for(a=500;a>0;){if(u.has(a))return u.get(a);a-=100}}}}catch(g){l.e(g)}finally{l.f()}}));class Oe{constructor(e){d(this,"textRenderers",void 0),this.textRenderers=e}addFontFace(e){for(var t in this.textRenderers){var r=this.textRenderers[t];r&&r.isFontFaceSupported(e)&&r.addFontFace(e)}}static resolveFontFace(e,t){var r=t.fontFamily,i=t.fontWeight,n=t.fontStyle,o=t.fontStretch;return Pe(e,r,i,n,o)}}var $e={x:0,y:0,width:0,height:0};class De extends V{constructor(e){super(e),d(this,"ssdfFontFamilies",{}),d(this,"msdfFontFamilies",{}),d(this,"fontFamilyArray",[this.ssdfFontFamilies,this.msdfFontFamilies]),d(this,"sdfShader",void 0),d(this,"rendererBounds",void 0),this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader,this.rendererBounds={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight}}getPropertySetters(){return{fontFamily:(e,t)=>{e.props.fontFamily=t,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontWeight:(e,t)=>{e.props.fontWeight=t,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStyle:(e,t)=>{e.props.fontStyle=t,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontStretch:(e,t)=>{e.props.fontStretch=t,this.releaseFontFace(e),this.invalidateLayoutCache(e)},fontSize:(e,t)=>{e.props.fontSize=t,this.invalidateLayoutCache(e)},text:(e,t)=>{e.props.text=t,this.invalidateLayoutCache(e)},textAlign:(e,t)=>{e.props.textAlign=t,this.invalidateLayoutCache(e)},color:(e,t)=>{e.props.color=t},x:(e,t)=>{e.props.x=t,e.elementBounds.valid&&(this.setElementBoundsX(e),!e.renderWindow.valid&&_(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},y:(e,t)=>{e.props.y=t,e.elementBounds.valid&&(this.setElementBoundsY(e),!e.renderWindow.valid&&_(e.elementBounds,this.rendererBounds)&&this.scheduleUpdateState(e))},contain:(e,t)=>{e.props.contain=t,this.invalidateLayoutCache(e)},width:(e,t)=>{e.props.width=t,"none"!==e.props.contain&&this.invalidateLayoutCache(e)},height:(e,t)=>{e.props.height=t,"both"===e.props.contain&&this.invalidateLayoutCache(e)},offsetY:(e,t)=>{e.props.offsetY=t,this.invalidateLayoutCache(e)},scrollable:(e,t)=>{e.props.scrollable=t,this.invalidateLayoutCache(e)},scrollY:(e,t)=>{e.props.scrollY=t,this.scheduleUpdateState(e)},letterSpacing:(e,t)=>{e.props.letterSpacing=t,this.invalidateLayoutCache(e)},lineHeight:(e,t)=>{e.props.lineHeight=t,this.invalidateLayoutCache(e)},maxLines:(e,t)=>{e.props.maxLines=t,this.invalidateLayoutCache(e)},textBaseline:(e,t)=>{e.props.textBaseline=t,this.invalidateLayoutCache(e)},verticalAlign:(e,t)=>{e.props.verticalAlign=t,this.invalidateLayoutCache(e)},overflowSuffix:(e,t)=>{e.props.overflowSuffix=t,this.invalidateLayoutCache(e)},debug:(e,t)=>{e.props.debug=t}}}canRenderFont(e){var t=e.fontFamily;return t in this.ssdfFontFamilies||t in this.msdfFontFamilies||"$$SDF_FAILURE_TEST$$"===t}isFontFaceSupported(e){return e instanceof T}addFontFace(e){h(e instanceof T);var t=e.fontFamily,r="ssdf"===e.type?this.ssdfFontFamilies:"msdf"===e.type?this.msdfFontFamilies:void 0;if(r){var i=r[t];i||(i=new Set,r[t]=i),i.add(e)}else console.warn(`Invalid font face type: ${e.type}`)}createState(e){return{props:e,status:"initialState",updateScheduled:!1,emitter:new u,lineCache:[],forceFullLayoutCalc:!1,renderWindow:{screen:{x1:0,y1:0,x2:0,y2:0},sdf:{x1:0,y1:0,x2:0,y2:0},firstLineIdx:0,numLines:0,valid:!1},elementBounds:{x1:0,y1:0,x2:0,y2:0,valid:!1},clippingRect:{x:0,y:0,width:0,height:0,valid:!1},bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,isRenderable:!1,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(e){var t=e.trFontFace,r=e.textH,i=e.lineCache,n=e.debugData,o=e.forceFullLayoutCalc;if(n.updateCount++,"initialState"===e.status&&this.setStatus(e,"loading"),!t){if(t=this.resolveFontFace(e.props),e.trFontFace=t,!t){var s=`SdfTextRenderer: Could not resolve font face for family: '${e.props.fontFamily}'`;return console.error(s),void this.setStatus(e,"failed",new Error(s))}t.texture.setRenderableOwner(e,e.isRenderable)}if(t.loaded){h(t.data,"Font face data should be loaded");var a=e.props,l=a.text,d=a.fontSize,u=a.x,c=a.y,p=a.contain,f=a.width,v=a.height,g=a.lineHeight,m=a.verticalAlign,x=a.scrollable,y=a.overflowSuffix,w=a.maxLines,b="both"===p&&x?e.props.scrollY:0,T=e.renderWindow,S=t.data.info.size,C=d/S,R=g/C;e.distanceRange=C*t.data.distanceField.distanceRange;var I=24*l.length,N=e.vertexBuffer;(!N||N.length<I)&&(N=new Float32Array(2*I));var L=e.elementBounds;if(L.valid||(this.setElementBoundsX(e),this.setElementBoundsY(e),L.valid=!0),!o&&T.valid){var M=T.screen;if(u+M.x1<=L.x1&&u+M.x2>=L.x2&&c-b+M.y1<=L.y1&&c-b+M.y2>=L.y2)return void this.setStatus(e,"loaded");T.valid=!1,this.setStatus(e,"loading")}var k=e.props,B=k.offsetY,F=k.textAlign;if(!T.valid){if(!_(L,this.rendererBounds))return;Ee(T,u,c,b,g,"both"===p?L.y2-L.y1:0,L,C)}var E=function(e,t,r,i,n,o,s,a,l){var d=Math.min(Math.max(s.firstLineIdx,0),a.length),h=0;"middle"===i?h=(t-e)/2:"bottom"===i&&(h=t-e);var u=n/o+d*t+h;if(!(l&&u>=l/o))return{sdfX:0,sdfY:u,lineIndex:d}}(S,R,0,m,B,C,T,i,r);if(E){var A=e.props.letterSpacing,z=Fe(E.lineIndex,E.sdfX,E.sdfY,l,F,f,v,d,g,A,N,p,i,T.sdf,t,o,x,y,w);e.bufferUploaded=!1,e.bufferNumFloats=z.bufferNumFloats,e.bufferNumQuads=z.bufferNumQuads,e.vertexBuffer=N,e.renderWindow=T,n.lastLayoutNumCharacters=z.layoutNumCharacters,n.bufferSize=N.byteLength,z.fullyProcessed&&(e.textW=z.maxX*C,e.textH=z.maxY*C),this.setStatus(e,"loaded")}else this.setStatus(e,"loaded")}else t.once("loaded",(()=>{this.scheduleUpdateState(e)}))}renderQuads(e,t,r,i,n,o){var s,a;if(e.vertexBuffer){var l=this.stage.renderer;h(l instanceof S);var d=e.props,u=d.fontSize,c=d.color,p=d.contain,f=d.scrollable,g=d.zIndex,m=d.debug,x="both"===p&&f?e.props.scrollY:0,y=e.textW,w=void 0===y?0:y,b=e.textH,_=void 0===b?0:b,T=e.distanceRange,M=e.vertexBuffer,k=e.bufferUploaded,B=e.trFontFace,F=e.elementBounds,E=e.webGlBuffers;if(!E){var A=l.glw,z=4*Float32Array.BYTES_PER_ELEMENT,P=A.createBuffer();h(P),e.webGlBuffers=new C([{buffer:P,attributes:{a_position:{name:"a_position",size:2,type:A.FLOAT,normalized:!1,stride:z,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:A.FLOAT,normalized:!1,stride:z,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),e.bufferUploaded=!1,h(e.webGlBuffers),E=e.webGlBuffers}if(!k){var O,$,D=l.glw,Y=null!==(O=null===($=E)||void 0===$?void 0:$.getBuffer("a_textureCoordinate"))&&void 0!==O?O:null;D.arrayBufferData(Y,M,D.STATIC_DRAW),e.bufferUploaded=!0}if(h(B),f&&"both"===p){h(F.valid);var U=R(F,$e);r.valid?(e.clippingRect.valid=!0,r=v(r,U,e.clippingRect)):(e.clippingRect.valid=!0,r=I(U,e.clippingRect))}var W=new N(l.glw,l.options,E,this.sdfShader,{transform:t.data,color:L(c,i),size:u/((null===(s=B.data)||void 0===s?void 0:s.info.size)||0),scrollY:x,distanceRange:T,debug:m.sdfShaderDebug},i,r,{height:_,width:w},0,g,!1,n,o),H=null===(a=e.trFontFace)||void 0===a?void 0:a.texture;h(H);var X=this.stage.txManager.getCtxTexture(H);W.addTexture(X),W.length=e.bufferNumFloats,W.numQuads=e.bufferNumQuads,l.addRenderOp(W)}}setIsRenderable(e,t){var r;super.setIsRenderable(e,t),null===(r=e.trFontFace)||void 0===r||r.texture.setRenderableOwner(e,t)}destroyState(e){var t;super.destroyState(e),null===(t=e.trFontFace)||void 0===t||t.texture.setRenderableOwner(e,!1)}resolveFontFace(e){return Oe.resolveFontFace(this.fontFamilyArray,e)}releaseFontFace(e){e.trFontFace&&(e.trFontFace.texture.setRenderableOwner(e,!1),e.trFontFace=void 0)}invalidateLayoutCache(e){e.renderWindow.valid=!1,e.elementBounds.valid=!1,e.textH=void 0,e.textW=void 0,e.lineCache=[],this.setStatus(e,"loading"),this.scheduleUpdateState(e)}setElementBoundsX(e){var t=e.props,r=t.x,i=t.contain,n=t.width,o=e.elementBounds;o.x1=r,o.x2="none"!==i?r+n:1/0}setElementBoundsY(e){var t=e.props,r=t.y,i=t.contain,n=t.height,o=e.elementBounds;o.y1=r,o.y2="both"===i?r+n:1/0}}var Ye,Ue=Symbol("solid-proxy"),We={equals:(e,t)=>e===t},He=ut,Xe=1,je=2,Ge={owned:null,cleanups:null,context:null,owner:null},Ve=null,Ke=null,qe=null,Qe=null,Ze=null,Je=0;function et(e,t){var r=qe,i=Ve,n=0===e.length,o=void 0===t?i:t,s=n?Ge:{owned:null,cleanups:null,context:o?o.context:null,owner:o},a=n?e:()=>e((()=>nt((()=>vt(s)))));Ve=s,qe=null;try{return ht(a,!0)}finally{qe=r,Ve=i}}function tt(e,t){var r={value:e,observers:null,observerSlots:null,comparator:(t=t?Object.assign({},We,t):We).equals||void 0};return[ot.bind(r),e=>("function"==typeof e&&(e=e(r.value)),st(r,e))]}function rt(e,t,r){at(lt(e,t,!1,Xe))}function it(e,t,r){r=r?Object.assign({},We,r):We;var i=lt(e,t,!0,0);return i.observers=null,i.observerSlots=null,i.comparator=r.equals||void 0,at(i),ot.bind(i)}function nt(e){if(null===qe)return e();var t=qe;qe=null;try{return e()}finally{qe=t}}function ot(){if(this.sources&&this.state)if(this.state===Xe)at(this);else{var e=Qe;Qe=null,ht((()=>pt(this)),!1),Qe=e}if(qe){var t=this.observers?this.observers.length:0;qe.sources?(qe.sources.push(this),qe.sourceSlots.push(t)):(qe.sources=[this],qe.sourceSlots=[t]),this.observers?(this.observers.push(qe),this.observerSlots.push(qe.sources.length-1)):(this.observers=[qe],this.observerSlots=[qe.sources.length-1])}return this.value}function st(e,t,r){var i=e.value;return e.comparator&&e.comparator(i,t)||(e.value=t,e.observers&&e.observers.length&&ht((()=>{for(var t=0;t<e.observers.length;t+=1){var r=e.observers[t],i=Ke&&Ke.running;i&&Ke.disposed.has(r),(i?r.tState:r.state)||(r.pure?Qe.push(r):Ze.push(r),r.observers&&ft(r)),i||(r.state=Xe)}if(Qe.length>1e6)throw Qe=[],new Error}),!1)),t}function at(e){if(e.fn){vt(e);var t=Je;!function(e,t,r){var i,n=Ve,o=qe;qe=Ve=e;try{i=e.fn(t)}catch(s){return e.pure&&(e.state=Xe,e.owned&&e.owned.forEach(vt),e.owned=null),e.updatedAt=r+1,gt(s)}finally{qe=o,Ve=n}(!e.updatedAt||e.updatedAt<=r)&&(null!=e.updatedAt&&"observers"in e?st(e,i):e.value=i,e.updatedAt=r)}(e,e.value,t)}}function lt(e,t,r,i=Xe,n){var o={fn:e,state:i,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:Ve,context:Ve?Ve.context:null,pure:r};return null===Ve||Ve!==Ge&&(Ve.owned?Ve.owned.push(o):Ve.owned=[o]),o}function dt(e){if(0!==e.state){if(e.state===je)return pt(e);if(e.suspense&&nt(e.suspense.inFallback))return e.suspense.effects.push(e);for(var t=[e];(e=e.owner)&&(!e.updatedAt||e.updatedAt<Je);)e.state&&t.push(e);for(var r=t.length-1;r>=0;r--)if((e=t[r]).state===Xe)at(e);else if(e.state===je){var i=Qe;Qe=null,ht((()=>pt(e,t[0])),!1),Qe=i}}}function ht(e,t){if(Qe)return e();var r=!1;t||(Qe=[]),Ze?r=!0:Ze=[],Je++;try{var i=e();return function(e){Qe&&(ut(Qe),Qe=null);if(e)return;var t=Ze;Ze=null,t.length&&ht((()=>He(t)),!1)}(r),i}catch(n){r||(Ze=null),Qe=null,gt(n)}}function ut(e){for(var t=0;t<e.length;t++)dt(e[t])}function ct(e){var t,r=0;for(t=0;t<e.length;t++){var i=e[t];i.user?e[r++]=i:dt(i)}for(t=0;t<r;t++)dt(e[t])}function pt(e,t){e.state=0;for(var r=0;r<e.sources.length;r+=1){var i=e.sources[r];if(i.sources){var n=i.state;n===Xe?i!==t&&(!i.updatedAt||i.updatedAt<Je)&&dt(i):n===je&&pt(i,t)}}}function ft(e){for(var t=0;t<e.observers.length;t+=1){var r=e.observers[t];r.state||(r.state=je,r.pure?Qe.push(r):Ze.push(r),r.observers&&ft(r))}}function vt(e){var t;if(e.sources)for(;e.sources.length;){var r=e.sources.pop(),i=e.sourceSlots.pop(),n=r.observers;if(n&&n.length){var o=n.pop(),s=r.observerSlots.pop();i<n.length&&(o.sourceSlots[s]=i,n[i]=o,r.observerSlots[i]=s)}}if(e.owned){for(t=e.owned.length-1;t>=0;t--)vt(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function gt(e,t=Ve){var r=function(e){return e instanceof Error?e:new Error("string"==typeof e?e:"Unknown error",{cause:e})}(e);throw r}function mt(e,t){return nt((()=>e(t||{})))}function xt(){return!0}var yt={get:(e,t,r)=>t===Ue?r:e.get(t),has:(e,t)=>t===Ue||e.has(t),set:xt,deleteProperty:xt,getOwnPropertyDescriptor:(e,t)=>({configurable:!0,enumerable:!0,get:()=>e.get(t),set:xt,deleteProperty:xt}),ownKeys:e=>e.keys()};function wt(e){return(e="function"==typeof e?e():e)?e:{}}function bt(){for(var e=0,t=this.length;e<t;++e){var r=this[e]();if(void 0!==r)return r}}function _t(...e){for(var t=!1,r=0;r<e.length;r++){var i=e[r];t=t||!!i&&Ue in i,e[r]="function"==typeof i?(t=!0,it(i)):i}if(t)return new Proxy({get(t){for(var r=e.length-1;r>=0;r--){var i=wt(e[r])[t];if(void 0!==i)return i}},has(t){for(var r=e.length-1;r>=0;r--)if(t in wt(e[r]))return!0;return!1},keys(){for(var t=[],r=0;r<e.length;r++)t.push(...Object.keys(wt(e[r])));return[...new Set(t)]}},yt);for(var n={},o=Object.create(null),s=e.length-1;s>=0;s--){var a=e[s];if(a)for(var l=Object.getOwnPropertyNames(a),d=function(){var e=l[h];if("__proto__"===e||"constructor"===e)return 1;var t=Object.getOwnPropertyDescriptor(a,e);if(o[e]){var r=n[e];r&&(t.get?r.push(t.get.bind(a)):void 0!==t.value&&r.push((()=>t.value)))}else o[e]=t.get?{enumerable:!0,configurable:!0,get:bt.bind(n[e]=[t.get.bind(a)])}:void 0!==t.value?t:void 0},h=l.length-1;h>=0;h--)d()}for(var u={},c=Object.keys(o),p=c.length-1;p>=0;p--){var f=c[p],v=o[f];v&&v.get?Object.defineProperty(u,f,v):u[f]=v?v.value:void 0}return u}r("D",void 0);var Tt=e(tt(void 0),2),St=Tt[0],Ct=Tt[1];r("h",St);class Rt{constructor(e){d(this,"releaseCallback",void 0),this.releaseCallback=e}}class It extends Rt{constructor(e,t){var r,i;super(e),d(this,"textureMap",new Map),d(this,"zeroReferenceTextureSet",new Set),d(this,"options",void 0),this.options={textureCleanupIntervalMs:null!==(r=t.textureCleanupIntervalMs)&&void 0!==r?r:1e4,textureCleanupAgeThreadholdMs:null!==(i=t.textureCleanupAgeThreadholdMs)&&void 0!==i?i:6e4},setInterval((()=>{var e,t=Date.now(),r=this.options.textureCleanupAgeThreadholdMs,i=n(this.zeroReferenceTextureSet);try{for(i.s();!(e=i.n()).done;){var o=e.value;t-o.lastUpdate>r&&(this.releaseCallback(o.id),this.textureMap.delete(o.id),this.zeroReferenceTextureSet.delete(o))}}catch(s){i.e(s)}finally{i.f()}}),this.options.textureCleanupIntervalMs)}registerTexture(e){var t,r=null===(t=e.options)||void 0===t?void 0:t.id;if(h(r,"Texture must have an id to be registered"),!this.textureMap.has(r)){var i={id:r,nodeRefCount:0,lastUpdate:Date.now()};this.textureMap.set(r,i),this.zeroReferenceTextureSet.add(i)}}incrementTextureRefCount(e){var t,r=null===(t=e.options)||void 0===t?void 0:t.id;h(r,"Texture must have an id to be registered");var i=this.textureMap.get(r);i||(this.registerTexture(e),i=this.textureMap.get(r)),h(i,"Texture must have been registered"),"SubTexture"===e.txType&&this.incrementTextureRefCount(e.props.texture),i.nodeRefCount++,i.lastUpdate=Date.now(),this.zeroReferenceTextureSet.has(i)&&this.zeroReferenceTextureSet.delete(i)}decrementTextureRefCount(e){var t,r=null===(t=e.options)||void 0===t?void 0:t.id;h(r,"Texture must have an id to be registered");var i=this.textureMap.get(r);h(i,"Texture must have been registered"),i.nodeRefCount--,i.lastUpdate=Date.now(),0===i.nodeRefCount&&this.zeroReferenceTextureSet.add(i),"SubTexture"===e.txType&&this.decrementTextureRefCount(e.props.texture)}}class Nt extends Rt{constructor(e){super(e),d(this,"registry",void 0),this.registry=new FinalizationRegistry(e)}registerTexture(e){var t,r;h(null===(t=e.options)||void 0===t?void 0:t.id,"Texture must have an ID to be registered"),this.registry.register(e,null===(r=e.options)||void 0===r?void 0:r.id)}incrementTextureRefCount(){}decrementTextureRefCount(){}}var Lt={alpha:e=>1===e?null:{prop:"opacity",value:`${e}`},x:e=>({prop:"left",value:`${e}px`}),y:e=>({prop:"top",value:`${e}px`}),width:e=>0===e?null:{prop:"width",value:`${e}px`},height:e=>0===e?null:{prop:"height",value:`${e}px`},zIndex:()=>"zIndex",fontFamily:()=>"font-family",fontSize:()=>"font-size",fontStyle:()=>"font-style",fontWeight:()=>"font-weight",fontStretch:()=>"font-stretch",lineHeight:()=>"line-height",letterSpacing:()=>"letter-spacing",textAlign:()=>"text-align",overflowSuffix:()=>"overflow-suffix",maxLines:()=>"max-lines",contain:()=>"contain",verticalAlign:()=>"vertical-align",clipping:e=>!1===e?null:{prop:"overflow",value:e?"hidden":"visible"},rotation:e=>0===e?null:{prop:"transform",value:`rotate(${e}rad)`},scale:e=>1===e?null:{prop:"transform",value:`scale(${e})`},scaleX:e=>1===e?null:{prop:"transform",value:`scaleX(${e})`},scaleY:e=>1===e?null:{prop:"transform",value:`scaleY(${e})`},color:e=>0===e?null:{prop:"color",value:Mt(e)}},Mt=e=>`rgba(${e>>24&255},${e>>16&255},${e>>8&255},${(255&e)/255})`,kt={id:"id"};class Bt{constructor(e,t){var r,i,n,o,s,a;if(d(this,"root",null),d(this,"canvas",null),d(this,"height",1080),d(this,"width",1920),d(this,"scaleX",1),d(this,"scaleY",1),!M()){if(!t)throw new Error("settings is required");this.height=Math.ceil(null!==(r=t.appHeight)&&void 0!==r?r:1080/(null!==(i=t.deviceLogicalPixelRatio)&&void 0!==i?i:1)),this.width=Math.ceil(null!==(n=t.appWidth)&&void 0!==n?n:1900/(null!==(o=t.deviceLogicalPixelRatio)&&void 0!==o?o:1)),this.scaleX=null!==(s=t.deviceLogicalPixelRatio)&&void 0!==s?s:1,this.scaleY=null!==(a=t.deviceLogicalPixelRatio)&&void 0!==a?a:1,this.canvas=e,this.root=document.createElement("div"),this.setRootPosition(),document.body.appendChild(this.root),new MutationObserver(this.setRootPosition.bind(this)).observe(e,{attributes:!0,childList:!1,subtree:!1}),new ResizeObserver(this.setRootPosition.bind(this)).observe(e),window.addEventListener("resize",this.setRootPosition.bind(this)),console.warn("Inspector is enabled, this will impact performance")}}setRootPosition(){if(null!==this.root&&null!==this.canvas){var e=this.canvas.getBoundingClientRect(),t=document.documentElement.scrollTop+e.top,r=document.documentElement.scrollLeft+e.left;this.root.id="root",this.root.style.left=`${r}px`,this.root.style.top=`${t}px`,this.root.style.width=`${this.width}px`,this.root.style.height=`${this.height}px`,this.root.style.position="absolute",this.root.style.transformOrigin="0 0 0",this.root.style.transform=`scale(${this.scaleX}, ${this.scaleY})`,this.root.style.overflow="hidden",this.root.style.zIndex="65534"}}createDiv(e,t){var r=document.createElement("div");for(var i in r.style.position="absolute",r.id=e.id.toString(),t)this.updateNodeProperty(r,i,t[i]);return r}createNode(e,t){var r=e.createNode(t),i=this.createDiv(r,t);return i.node=r,r.div=i,this.createProxy(r,i)}createTextNode(e,t){var r=e.createTextNode(t),i=this.createDiv(r,t);return i.node=r,r.div=i,this.createProxy(r,i)}createProxy(e,t){return new Proxy(e,{set:(e,r,i)=>(this.updateNodeProperty(t,r,i),Reflect.set(e,r,i)),get:(r,i,n)=>("destroy"===i&&this.destroyNode(r),"animate"===i?(i,n)=>{var o=r.animate(i,n);return new Proxy(o,{get:(r,o,s)=>("start"===o&&this.animateNode(t,e,i,n),Reflect.get(r,o,s))})}:Reflect.get(r,i,n))})}destroyNode(e){var t=document.getElementById(e.id.toString());null==t||t.remove()}updateNodeProperty(e,t,r){if(null!==this.root&&null!=r)if("parent"!==t){if("text"===t)return e.innerHTML=String(r),void(e.style.visibility="hidden");if("src"===t&&r)e.setAttribute("data-src",String(r));else{if(Lt[t]){var i,n=null===(i=Lt[t])||void 0===i?void 0:i.call(Lt,r);if(null===n)return;return"string"==typeof n?void e.style.setProperty(n,String(r)):void("object"==typeof n&&e.style.setProperty(n.prop,n.value))}if(kt[t])e.setAttribute(String(Lt[t]),String(r));else if("data"!==t);else for(var o in r){var s=r[o];void 0===s?e.removeAttribute(`data-${o}`):e.setAttribute(`data-${o}`,String(s))}}}else{var a=r.id;if(1===a)return void this.root.appendChild(e);var l=document.getElementById(a.toString());null==l||l.appendChild(e)}}animateNode(e,t,r,i){var n=i.duration,o=void 0===n?1e3:n,s=i.delay,a=void 0===s?0:s,l=r.x,d=r.y,h=r.width,u=r.height,c=r.alpha,p=void 0===c?1:c,f=r.rotation,v=void 0===f?0:f,g=r.scale,m=void 0===g?1:g,x=r.color;setTimeout((function(){setTimeout((()=>{e.style.top=`${d}px`,e.style.left=`${l}px`,e.style.width=`${h}px`,e.style.height=`${u}px`,e.style.opacity=`${p}`,e.style.rotate=`${v}rad`,e.style.scale=`${m}`,e.style.color=Mt(x)}),o)}),a)}}function Ft(e,t){return Et.apply(this,arguments)}function Et(){return(Et=i(t().mark((function e(r,i){var n,s,a;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,console.log("Loading core extension",r),e.next=4,o.import(r);case 4:n=e.sent,e.next=12;break;case 7:return e.prev=7,e.t0=e.catch(0),console.error(`The core extension module at '${r}' could not be loaded.`),console.error(e.t0),e.abrupt("return");case 12:if(n.default){e.next=15;break}return console.error(`The core extension module at '${r}' does not have a default export.`),e.abrupt("return");case 15:if(s=n.default,!(s.prototype instanceof k)){e.next=29;break}return a=new s,e.prev=18,e.next=21,a.run(i);case 21:e.next=27;break;case 23:e.prev=23,e.t1=e.catch(18),console.error(`The core extension at '${r}' threw an error.`),console.error(e.t1);case 27:e.next=30;break;case 29:console.error(`The core extension at '${r}' does not extend CoreExtension.`);case 30:case"end":return e.stop()}}),e,null,[[0,7],[18,23]])})))).apply(this,arguments)}function At(e){for(var t={boolean:!0,string:!0,number:!0,undefined:!0},r=Object.keys(e),i=0;i<r.length;i++){var n=r[i];if(n){var o=e[n],s=typeof o;"string"===s&&o.length>2048&&(console.warn(`Custom Data value for ${n} is too long, it will be truncated to 2048 characters`),e[n]=o.substring(0,2048)),t[s]||(console.warn(`Custom Data value for ${n} is not a boolean, string, or number, it will be ignored`),delete e[n])}}return e}class zt extends u{constructor(e,t,r){var i,n,o,s,a;super(),d(this,"root",null),d(this,"driver",void 0),d(this,"canvas",void 0),d(this,"settings",void 0),d(this,"inspector",null),d(this,"nodes",new Map),d(this,"nextTextureId",1),d(this,"textureTracker",void 0);var l={appWidth:e.appWidth||1920,appHeight:e.appHeight||1080,txMemByteThreshold:e.txMemByteThreshold||124e6,boundsMargin:e.boundsMargin||0,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:null!==(i=e.clearColor)&&void 0!==i?i:0,coreExtensionModule:e.coreExtensionModule||null,experimental_FinalizationRegistryTextureUsageTracker:null!==(n=e.experimental_FinalizationRegistryTextureUsageTracker)&&void 0!==n&&n,textureCleanupOptions:e.textureCleanupOptions||{},fpsUpdateInterval:e.fpsUpdateInterval||0,numImageWorkers:void 0!==e.numImageWorkers?e.numImageWorkers:2,enableContextSpy:null!==(o=e.enableContextSpy)&&void 0!==o&&o,enableInspector:null!==(s=e.enableInspector)&&void 0!==s&&s,renderMode:null!==(a=e.renderMode)&&void 0!==a?a:"webgl"};this.settings=l;var h=l.appWidth,u=l.appHeight,c=l.deviceLogicalPixelRatio,p=l.devicePhysicalPixelRatio,f=l.enableInspector,v=e=>{this.driver.releaseTexture(e)},g=l.experimental_FinalizationRegistryTextureUsageTracker&&"function"==typeof FinalizationRegistry;this.textureTracker=g?new Nt(v):new It(v,this.settings.textureCleanupOptions);var m=h*c,x=u*c;this.driver=r;var y,w=document.createElement("canvas");if(this.canvas=w,w.width=m*p,w.height=x*p,w.style.width=`${m}px`,w.style.height=`${x}px`,!(y="string"==typeof t?document.getElementById(t):t))throw new Error("Could not find target element");r.onCreateNode=e=>{this.nodes.set(e.id,e)},r.onBeforeDestroyNode=e=>{this.nodes.delete(e.id)},r.onFpsUpdate=e=>{this.emit("fpsUpdate",e)},r.onFrameTick=e=>{this.emit("frameTick",e)},r.onIdle=()=>{this.emit("idle")},y.appendChild(w),f&&!M()&&(this.inspector=new Bt(w,l))}init(){var e=this;return i(t().mark((function r(){return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.driver.init(e,e.settings,e.canvas);case 2:e.root=e.driver.getRootNode();case 3:case"end":return t.stop()}}),r)})))()}createNode(e){return this.inspector?this.inspector.createNode(this.driver,this.resolveNodeDefaults(e)):this.driver.createNode(this.resolveNodeDefaults(e))}createTextNode(e){var t,r,i,n,o,s,a,d,h,u,c,p,f,v,g,m,x,y,w,b=null!==(t=e.fontSize)&&void 0!==t?t:16,_=l(l({},this.resolveNodeDefaults(e)),{},{text:null!==(r=e.text)&&void 0!==r?r:"",textRendererOverride:null!==(i=e.textRendererOverride)&&void 0!==i?i:null,fontSize:b,fontFamily:null!==(n=e.fontFamily)&&void 0!==n?n:"sans-serif",fontStyle:null!==(o=e.fontStyle)&&void 0!==o?o:"normal",fontWeight:null!==(s=e.fontWeight)&&void 0!==s?s:"normal",fontStretch:null!==(a=e.fontStretch)&&void 0!==a?a:"normal",textAlign:null!==(d=e.textAlign)&&void 0!==d?d:"left",contain:null!==(h=e.contain)&&void 0!==h?h:"none",scrollable:null!==(u=e.scrollable)&&void 0!==u&&u,scrollY:null!==(c=e.scrollY)&&void 0!==c?c:0,offsetY:null!==(p=e.offsetY)&&void 0!==p?p:0,letterSpacing:null!==(f=e.letterSpacing)&&void 0!==f?f:0,lineHeight:null!==(v=e.lineHeight)&&void 0!==v?v:b,maxLines:null!==(g=e.maxLines)&&void 0!==g?g:0,textBaseline:null!==(m=e.textBaseline)&&void 0!==m?m:"alphabetic",verticalAlign:null!==(x=e.verticalAlign)&&void 0!==x?x:"top",overflowSuffix:null!==(y=e.overflowSuffix)&&void 0!==y?y:"...",debug:null!==(w=e.debug)&&void 0!==w?w:{}});return this.inspector?this.inspector.createTextNode(this.driver,_):this.driver.createTextNode(_)}resolveNodeDefaults(e){var t,r,i,n,o,s,a,l,d,h,u,c,p,f,v,g,m,x,y,w,b,_,T,S,C,R,I,N,L,M,k,B,F,E,A,z,P,O,$,D,Y,U,W,H,X,j,G,V,K=null!==(t=e.color)&&void 0!==t?t:4294967295,q=null!==(r=null!==(i=null!==(n=e.colorTl)&&void 0!==n?n:e.colorTop)&&void 0!==i?i:e.colorLeft)&&void 0!==r?r:K,Q=null!==(o=null!==(s=null!==(a=e.colorTr)&&void 0!==a?a:e.colorTop)&&void 0!==s?s:e.colorRight)&&void 0!==o?o:K,Z=null!==(l=null!==(d=null!==(h=e.colorBl)&&void 0!==h?h:e.colorBottom)&&void 0!==d?d:e.colorLeft)&&void 0!==l?l:K,J=null!==(u=null!==(c=null!==(p=e.colorBr)&&void 0!==p?p:e.colorBottom)&&void 0!==c?c:e.colorRight)&&void 0!==u?u:K,ee=At(null!==(f=e.data)&&void 0!==f?f:{});return{x:null!==(v=e.x)&&void 0!==v?v:0,y:null!==(g=e.y)&&void 0!==g?g:0,width:null!==(m=e.width)&&void 0!==m?m:0,height:null!==(x=e.height)&&void 0!==x?x:0,alpha:null!==(y=e.alpha)&&void 0!==y?y:1,autosize:null!==(w=e.autosize)&&void 0!==w&&w,clipping:null!==(b=e.clipping)&&void 0!==b&&b,color:K,colorTop:null!==(_=e.colorTop)&&void 0!==_?_:K,colorBottom:null!==(T=e.colorBottom)&&void 0!==T?T:K,colorLeft:null!==(S=e.colorLeft)&&void 0!==S?S:K,colorRight:null!==(C=e.colorRight)&&void 0!==C?C:K,colorBl:Z,colorBr:J,colorTl:q,colorTr:Q,zIndex:null!==(R=e.zIndex)&&void 0!==R?R:0,zIndexLocked:null!==(I=e.zIndexLocked)&&void 0!==I?I:0,parent:null!==(N=e.parent)&&void 0!==N?N:null,texture:null!==(L=e.texture)&&void 0!==L?L:null,shader:null!==(M=e.shader)&&void 0!==M?M:null,src:null!==(k=e.src)&&void 0!==k?k:"",scale:null!==(B=e.scale)&&void 0!==B?B:null,scaleX:null!==(F=null!==(E=e.scaleX)&&void 0!==E?E:e.scale)&&void 0!==F?F:1,scaleY:null!==(A=null!==(z=e.scaleY)&&void 0!==z?z:e.scale)&&void 0!==A?A:1,mount:null!==(P=e.mount)&&void 0!==P?P:0,mountX:null!==(O=null!==($=e.mountX)&&void 0!==$?$:e.mount)&&void 0!==O?O:0,mountY:null!==(D=null!==(Y=e.mountY)&&void 0!==Y?Y:e.mount)&&void 0!==D?D:0,pivot:null!==(U=e.pivot)&&void 0!==U?U:.5,pivotX:null!==(W=null!==(H=e.pivotX)&&void 0!==H?H:e.pivot)&&void 0!==W?W:.5,pivotY:null!==(X=null!==(j=e.pivotY)&&void 0!==j?j:e.pivot)&&void 0!==X?X:.5,rotation:null!==(G=e.rotation)&&void 0!==G?G:0,rtt:null!==(V=e.rtt)&&void 0!==V&&V,data:ee}}destroyNode(e){return this.inspector&&this.inspector.destroyNode(e),this.driver.destroyNode(e)}createTexture(e,t,r){var i=this.nextTextureId++,n={descType:"texture",txType:e,props:t,options:l(l({},r),{},{id:i})};return this.textureTracker.registerTexture(n),n}createShader(e,t){return{descType:"shader",shType:e,props:t}}getNodeById(e){return this.nodes.get(e)||null}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}rerender(){throw new Error("Not implemented")}}class Pt extends u{constructor(e,t,r){super(),d(this,"node",void 0),d(this,"props",void 0),d(this,"settings",void 0),d(this,"propStartValues",{}),d(this,"restoreValues",{}),d(this,"progress",0),d(this,"delayFor",0),d(this,"timingFunction",void 0),d(this,"propsList",void 0),this.node=e,this.props=t,this.settings=r,this.propStartValues={},this.propsList=Object.keys(t),this.propsList.forEach((t=>{this.propStartValues[t]=e[t]})),this.timingFunction=e=>e,r.easing&&"string"==typeof r.easing&&(this.timingFunction=B(r.easing)),this.delayFor=r.delay||0}reset(){this.progress=0,this.delayFor=this.settings.delay||0,this.update(0)}restore(){this.reset(),Object.keys(this.props).forEach((e=>{this.node[e]=this.propStartValues[e]}))}reverse(){this.progress=0,Object.keys(this.props).forEach((e=>{var t=this.props[e],r=this.propStartValues[e];this.props[e]=r,this.propStartValues[e]=t})),this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(e,t,r){return(this.timingFunction(e)||e)*(r-t)+t}update(e){var t=this.settings,r=t.duration,i=t.loop,n=t.easing,o=t.stopMethod;if(r)if(this.delayFor>0)this.delayFor-=e;else if(this.delayFor<=0&&0===this.progress&&this.emit("start",{}),this.progress+=e/r,this.progress>1&&(this.progress=i?0:1,o))this.emit("finished",{});else{for(var s=0;s<this.propsList.length;s++){var a=this.propsList[s],l=this.props[a],d=this.propStartValues[a],h=l;if(-1===a.indexOf("color"))this.node[a]=n?this.applyEasing(this.progress,d,h):d+(h-d)*this.progress;else{if(d===h){this.node[a]=d;continue}if(n){var u=this.timingFunction(this.progress)||this.progress,c=F(d,h,u);this.node[a]=c;continue}this.node[a]=F(d,h,this.progress)}}1===this.progress&&this.emit("finished",{})}else this.emit("finished",{})}}class Ot{constructor(e,t){d(this,"manager",void 0),d(this,"animation",void 0),d(this,"startedPromise",null),d(this,"startedResolve",null),d(this,"stoppedPromise",null),d(this,"stoppedResolve",null),d(this,"state",void 0),this.manager=e,this.animation=t,this.state="stopped"}start(){return this.makeStartedPromise(),this.animation.once("start",this.started.bind(this)),this.makeStoppedPromise(),this.animation.once("finished",this.finished.bind(this)),this.manager.activeAnimations.has(this.animation)||this.manager.registerAnimation(this.animation),this.state="running",this}stop(){return this.manager.unregisterAnimation(this.animation),null!==this.stoppedResolve&&(this.stoppedResolve(),this.stoppedResolve=null),this.animation.reset(),this.state="stopped",this}pause(){return this.manager.unregisterAnimation(this.animation),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStarted(){this.makeStartedPromise();var e=this.startedPromise;return h(e),e}waitUntilStopped(){this.makeStoppedPromise();var e=this.stoppedPromise;return h(e),e}makeStartedPromise(){null===this.startedResolve&&(this.startedPromise=new Promise((e=>{this.startedResolve=e})))}makeStoppedPromise(){null===this.stoppedResolve&&(this.stoppedPromise=new Promise((e=>{this.stoppedResolve=e})))}started(){h(this.startedResolve),this.startedResolve(this),this.startedResolve=null}finished(){h(this.stoppedResolve);var e=this.animation.settings,t=e.loop;if("reverse"===e.stopMethod)return this.animation.reverse(),void this.start();this.stoppedResolve(),this.stoppedResolve=null,t||this.manager.unregisterAnimation(this.animation)}}class $t{constructor(e){d(this,"data",void 0),e?(this.data=new Float32Array(9),this.data[0]=e[0],this.data[3]=e[3],this.data[6]=e[6],this.data[1]=e[1],this.data[4]=e[4],this.data[7]=e[7],this.data[2]=e[2],this.data[5]=e[5],this.data[8]=e[8]):this.data=new Float32Array(9)}static get temp(){return Yt}static multiply(e,t,r){var i=e.data[0]*t.data[0]+e.data[3]*t.data[1]+e.data[6]*t.data[2],n=e.data[0]*t.data[3]+e.data[3]*t.data[4]+e.data[6]*t.data[5],o=e.data[0]*t.data[6]+e.data[3]*t.data[7]+e.data[6]*t.data[8],s=e.data[1]*t.data[0]+e.data[4]*t.data[1]+e.data[7]*t.data[2],a=e.data[1]*t.data[3]+e.data[4]*t.data[4]+e.data[7]*t.data[5],l=e.data[1]*t.data[6]+e.data[4]*t.data[7]+e.data[7]*t.data[8],d=e.data[2]*t.data[0]+e.data[5]*t.data[1]+e.data[8]*t.data[2],h=e.data[2]*t.data[3]+e.data[5]*t.data[4]+e.data[8]*t.data[5],u=e.data[2]*t.data[6]+e.data[5]*t.data[7]+e.data[8]*t.data[8];return r||(r=new $t),r.data[0]=i,r.data[3]=n,r.data[6]=o,r.data[1]=s,r.data[4]=a,r.data[7]=l,r.data[2]=d,r.data[5]=h,r.data[8]=u,r}static identity(e){return e||(e=new $t),e.data[0]=1,e.data[3]=0,e.data[6]=0,e.data[1]=0,e.data[4]=1,e.data[7]=0,e.data[2]=0,e.data[5]=0,e.data[8]=1,e}static translate(e,t,r){return r||(r=new $t),r.data[0]=1,r.data[3]=0,r.data[6]=e,r.data[1]=0,r.data[4]=1,r.data[7]=t,r.data[2]=0,r.data[5]=0,r.data[8]=1,r}static scale(e,t,r){return r||(r=new $t),r.data[0]=e,r.data[3]=0,r.data[6]=0,r.data[1]=0,r.data[4]=t,r.data[7]=0,r.data[2]=0,r.data[5]=0,r.data[8]=1,r}static rotate(e,t){var r=Math.cos(e),i=Math.sin(e);return t||(t=new $t),t.data[0]=r,t.data[3]=-i,t.data[6]=0,t.data[1]=i,t.data[4]=r,t.data[7]=0,t.data[2]=0,t.data[5]=0,t.data[8]=1,t}static copy(e,t,r){return t||(t=new $t),t.data[0]=e.data[0],t.data[1]=e.data[1],t.data[2]=e.data[2],t.data[3]=e.data[3],t.data[4]=e.data[4],t.data[5]=e.data[5],t.data[6]=e.data[6],t.data[7]=e.data[7],t.data[8]=e.data[8],t}translate(e,t){return this.data[6]=this.data[0]*e+this.data[3]*t+this.data[6],this.data[7]=this.data[1]*e+this.data[4]*t+this.data[7],this}scale(e,t){return this.data[0]=this.data[0]*e,this.data[3]=this.data[3]*t,this.data[1]=this.data[1]*e,this.data[4]=this.data[4]*t,this}rotate(e){if(0===e||!(e%Math.PI*2))return this;var t=Math.cos(e),r=Math.sin(e),i=this.data[0]*t+this.data[3]*r,n=this.data[3]*t-this.data[0]*r,o=this.data[1]*t+this.data[4]*r,s=this.data[4]*t-this.data[1]*r;return this.data[0]=i,this.data[3]=n,this.data[1]=o,this.data[4]=s,this}multiply(e){return $t.multiply(this,e,this)}get tx(){return this.data[6]}get ty(){return this.data[7]}get ta(){return this.data[0]}get tb(){return this.data[3]}get tc(){return this.data[1]}get td(){return this.data[4]}transformPoint(e,t){return[this.data[0]*e+this.data[3]*t+this.data[6],this.data[1]*e+this.data[4]*t+this.data[1]]}}var Dt,Yt=new $t;class Ut{constructor(e){d(this,"data",void 0),this.data=new Float32Array(8),e&&(this.data[0]=e[0],this.data[2]=e[2],this.data[4]=e[4],this.data[6]=e[6],this.data[1]=e[1],this.data[3]=e[3],this.data[5]=e[5],this.data[7]=e[7])}static translate(e,t,r,i,n,o,s,a,l){return l||(l=new Ut),l.data[0]=e,l.data[2]=r,l.data[4]=n,l.data[6]=s,l.data[1]=t,l.data[3]=i,l.data[5]=o,l.data[7]=a,l}get x1(){return this.data[0]}get x2(){return this.data[2]}get x3(){return this.data[4]}get x4(){return this.data[6]}get y1(){return this.data[1]}get y2(){return this.data[3]}get y3(){return this.data[5]}get y4(){return this.data[7]}}!function(e){e[e.Init=0]="Init",e[e.OutOfBounds=2]="OutOfBounds",e[e.InBounds=4]="InBounds",e[e.InViewport=8]="InViewport"}(Dt||(Dt={}));var Wt,Ht=new Map;Ht.set(Dt.Init,"init"),Ht.set(Dt.OutOfBounds,"outOfBounds"),Ht.set(Dt.InBounds,"inBounds"),Ht.set(Dt.InViewport,"inViewport"),function(e){e[e.Children=1]="Children",e[e.ScaleRotate=2]="ScaleRotate",e[e.Local=4]="Local",e[e.Global=8]="Global",e[e.Clipping=16]="Clipping",e[e.CalculatedZIndex=32]="CalculatedZIndex",e[e.ZIndexSortedChildren=64]="ZIndexSortedChildren",e[e.PremultipliedColors=128]="PremultipliedColors",e[e.WorldAlpha=256]="WorldAlpha",e[e.RenderState=512]="RenderState",e[e.IsRenderable=1024]="IsRenderable",e[e.RenderTexture=2048]="RenderTexture",e[e.ParentRenderTexture=4096]="ParentRenderTexture",e[e.None=0]="None",e[e.All=8191]="All"}(Wt||(Wt={}));class Xt extends u{constructor(e,t){super(),d(this,"stage",void 0),d(this,"children",[]),d(this,"props",void 0),d(this,"updateType",Wt.All),d(this,"globalTransform",void 0),d(this,"scaleRotateTransform",void 0),d(this,"localTransform",void 0),d(this,"renderCoords",void 0),d(this,"renderBound",void 0),d(this,"strictBound",void 0),d(this,"preloadBound",void 0),d(this,"clippingRect",{x:0,y:0,width:0,height:0,valid:!1}),d(this,"isRenderable",!1),d(this,"renderState",Dt.Init),d(this,"worldAlpha",1),d(this,"premultipliedColorTl",0),d(this,"premultipliedColorTr",0),d(this,"premultipliedColorBl",0),d(this,"premultipliedColorBr",0),d(this,"calcZIndex",0),d(this,"hasRTTupdates",!1),d(this,"parentHasRenderTexture",!1),d(this,"onTextureLoaded",((e,t)=>{this.autosizeNode(t),this.stage.requestRender(),this.parentHasRenderTexture&&this.setRTTUpdates(1),this.emit("loaded",{type:"texture",dimensions:t})})),d(this,"onTextureFailed",((e,t)=>{this.emit("failed",{type:"texture",error:t})})),d(this,"onTextureFreed",(e=>{this.emit("freed",{type:"texture"})})),this.stage=e,this.props=l(l({},t),{},{parent:null}),this.parent=t.parent,this.rtt=t.rtt,this.updateScaleRotateTransform()}loadTexture(e,t,r=null){this.props.texture&&this.unloadTexture();var i=this.stage.txManager.loadTexture(e,t,r);this.props.texture=i,this.props.textureOptions=r,this.setUpdateType(Wt.IsRenderable),queueMicrotask((()=>{"loaded"===i.state?this.onTextureLoaded(i,i.dimensions):"failed"===i.state?this.onTextureFailed(i,i.error):"freed"===i.state&&this.onTextureFreed(i),i.on("loaded",this.onTextureLoaded),i.on("failed",this.onTextureFailed),i.on("freed",this.onTextureFreed)}))}unloadTexture(){if(this.props.texture){var e=this.props.texture;e.off("loaded",this.onTextureLoaded),e.off("failed",this.onTextureFailed),e.off("freed",this.onTextureFreed),e.setRenderableOwner(this,!1)}this.props.texture=null,this.props.textureOptions=null,this.setUpdateType(Wt.IsRenderable)}autosizeNode(e){this.autosize&&(this.width=e.width,this.height=e.height)}loadShader(e,t){var r=this.stage.renderer.getShaderManager();h(r);var i=r.loadShader(e,t),n=i.shader,o=i.props;this.props.shader=n,this.props.shaderProps=o,this.setUpdateType(Wt.IsRenderable)}setUpdateType(e){this.updateType|=e;var t=this.props.parent;!t||t.updateType&Wt.Children||t.setUpdateType(Wt.Children),this.parentHasRenderTexture&&this.setRTTUpdates(e)}sortChildren(){this.children.sort(((e,t)=>e.calcZIndex-t.calcZIndex))}updateScaleRotateTransform(){this.scaleRotateTransform=$t.rotate(this.props.rotation,this.scaleRotateTransform).scale(this.props.scaleX,this.props.scaleY)}updateLocalTransform(){h(this.scaleRotateTransform);var e=this.props.pivotX*this.props.width,t=this.props.pivotY*this.props.height,r=this.props.mountX*this.props.width,i=this.props.mountY*this.props.height;this.localTransform=$t.translate(e-r+this.props.x,t-i+this.props.y,this.localTransform).multiply(this.scaleRotateTransform).translate(-e,-t),this.setUpdateType(Wt.Global)}update(e,t){this.updateType&Wt.ScaleRotate&&(this.updateScaleRotateTransform(),this.setUpdateType(Wt.Local)),this.updateType&Wt.Local&&(this.updateLocalTransform(),this.setUpdateType(Wt.Global));var r,i=this.props.parent,n=Wt.None;if(this.updateType&Wt.ParentRenderTexture)for(var o=this.parent;o;)o.rtt&&(this.parentHasRenderTexture=!0),o=o.parent;(this.updateType^Wt.All&&this.updateType&Wt.RenderTexture&&this.children.forEach((e=>{e.setUpdateType(Wt.All)})),this.updateType&Wt.Global)&&(h(this.localTransform),this.globalTransform=$t.copy((null==i?void 0:i.globalTransform)||this.localTransform,this.globalTransform),this.parentHasRenderTexture&&null!==(r=this.props.parent)&&void 0!==r&&r.rtt&&(this.globalTransform=$t.identity()),i&&this.globalTransform.multiply(this.localTransform),this.calculateRenderCoords(),this.updateBoundingRect(),this.setUpdateType(Wt.Clipping|Wt.RenderState|Wt.Children),n|=Wt.Global);this.updateType&Wt.Clipping&&(this.calculateClippingRect(t),this.setUpdateType(Wt.Children),n|=Wt.Clipping),this.updateType&Wt.WorldAlpha&&(this.worldAlpha=i?i.worldAlpha*this.props.alpha:this.props.alpha,this.setUpdateType(Wt.Children|Wt.PremultipliedColors|Wt.IsRenderable),n|=Wt.WorldAlpha),this.updateType&Wt.PremultipliedColors&&(this.premultipliedColorTl=m(this.props.colorTl,this.worldAlpha,!0),this.props.colorTl===this.props.colorTr&&this.props.colorBl===this.props.colorBr&&this.props.colorTl===this.props.colorBl?this.premultipliedColorTr=this.premultipliedColorBl=this.premultipliedColorBr=this.premultipliedColorTl:(this.premultipliedColorTr=m(this.props.colorTr,this.worldAlpha,!0),this.premultipliedColorBl=m(this.props.colorBl,this.worldAlpha,!0),this.premultipliedColorBr=m(this.props.colorBr,this.worldAlpha,!0))),this.updateType&Wt.RenderState&&(this.updateRenderState(t),this.setUpdateType(Wt.IsRenderable)),this.updateType&Wt.IsRenderable&&this.updateIsRenderable(),i&&this.updateType&Wt.CalculatedZIndex&&(this.calculateZIndex(),i.setUpdateType(Wt.ZIndexSortedChildren)),this.updateType&Wt.Children&&this.children.length&&!this.rtt&&this.children.forEach((t=>{t.setUpdateType(n),0!==t.updateType&&t.update(e,this.clippingRect)})),this.updateType&Wt.ZIndexSortedChildren&&this.sortChildren(),this.updateType=0}checkRenderProps(){return!!this.props.texture||!(!this.props.width||!this.props.height)&&(!!this.props.shader||(!!this.props.clipping||(0!==this.props.color||(0!==this.props.colorTop||(0!==this.props.colorBottom||(0!==this.props.colorLeft||(0!==this.props.colorRight||(0!==this.props.colorTl||(0!==this.props.colorTr||(0!==this.props.colorBl||0!==this.props.colorBr))))))))))}checkRenderBounds(e){h(this.renderBound);var t=e.width||this.stage.root.width,r=e.height||this.stage.root.height;this.strictBound=p(e.x,e.y,e.x+t,e.y+r,this.strictBound);var i=this.stage.boundsMargin;return this.preloadBound=p(e.x-i[3],e.y-i[0],e.x+t+i[1],e.y+r+i[2],this.preloadBound),E(this.renderBound,this.strictBound)?Dt.InViewport:E(this.renderBound,this.preloadBound)?Dt.InBounds:Dt.OutOfBounds}updateRenderState(e){var t=this.checkRenderBounds(e);if(t!==this.renderState){var r=this.renderState;this.renderState=t,r===Dt.InViewport&&this.emit("outOfViewport",{previous:r,current:t}),(r<Dt.InBounds&&t===Dt.InViewport||r>Dt.InBounds&&t===Dt.OutOfBounds)&&(this.emit(Ht.get(Dt.InBounds),{previous:r,current:t}),r=Dt.InBounds);var i=Ht.get(t);h(i),this.emit(i,{previous:r,current:t})}}setRenderState(e){e!==this.renderState&&(this.renderState=e,this.emit(Dt[e]))}updateIsRenderable(){var e;e=!(0===this.worldAlpha||!this.checkRenderProps())&&this.renderState>Dt.OutOfBounds,this.isRenderable!==e&&(this.isRenderable=e,this.onChangeIsRenderable(e))}onChangeIsRenderable(e){var t;null===(t=this.props.texture)||void 0===t||t.setRenderableOwner(this,e)}calculateRenderCoords(){var e=this.width,t=this.height,r=this.globalTransform;h(r);var i=r.tx,n=r.ty,o=r.ta,s=r.tb,a=r.tc,l=r.td;if(0===s&&0===a){var d=i,u=i+e*o,c=n,p=n+t*l;this.renderCoords=Ut.translate(d,c,u,c,u,p,d,p,this.renderCoords)}else this.renderCoords=Ut.translate(i,n,i+e*o,n+e*a,i+e*o+t*s,n+e*a+t*l,i+t*s,n+t*l,this.renderCoords)}updateBoundingRect(){var e=this.renderCoords,t=this.globalTransform;h(t),h(e);var r=t.tb,i=t.tc,n=e.x1,o=e.y1,s=e.x3,a=e.y3;if(0===r||0===i)this.renderBound=p(n,o,s,a,this.renderBound);else{var l=e.x2,d=e.x4,u=e.y2,c=e.y4;this.renderBound=p(Math.min(n,l,s,d),Math.min(o,u,a,c),Math.max(n,l,s,d),Math.max(o,u,a,c),this.renderBound)}}calculateClippingRect(e){h(this.globalTransform);var t=this.clippingRect,r=this.props,i=this.globalTransform,n=r.clipping,o=0!==i.tb||0!==i.tc;n&&!o?(t.x=i.tx,t.y=i.ty,t.width=this.width*i.ta,t.height=this.height*i.td,t.valid=!0):t.valid=!1,e.valid&&t.valid?v(e,t,t):e.valid&&(I(e,t),t.valid=!0)}calculateZIndex(){var e,t,r=this.props,i=r.zIndex||0,n=(null===(e=r.parent)||void 0===e?void 0:e.zIndex)||0,o=i;null!==(t=r.parent)&&void 0!==t&&t.zIndexLocked&&(o=i<n?i:n),this.calcZIndex=o}destroy(){this.unloadTexture(),this.clippingRect.valid=!1,this.isRenderable=!1,delete this.renderCoords,delete this.renderBound,delete this.strictBound,delete this.preloadBound,delete this.globalTransform,delete this.scaleRotateTransform,delete this.localTransform,this.props.texture=null,this.props.shader=null,this.rtt&&this.stage.renderer.removeRTTNode(this),this.removeAllListeners(),this.parent=null}renderQuads(e){var t=this.props,r=t.width,i=t.height,n=t.texture,o=t.textureOptions,s=t.shader,a=t.shaderProps,l=t.rtt;if(this.parentHasRenderTexture){if(!e.renderToTextureActive)return;if(this.parentRenderTexture!==e.activeRttNode)return}var d=this.premultipliedColorTl,u=this.premultipliedColorTr,c=this.premultipliedColorBl,p=this.premultipliedColorBr,f=this.zIndex,v=this.worldAlpha,g=this.globalTransform,m=this.clippingRect;h(g),e.addQuad({width:r,height:i,colorTl:d,colorTr:u,colorBl:c,colorBr:p,texture:n,textureOptions:o,zIndex:f,shader:s,shaderProps:a,alpha:v,clippingRect:m,tx:g.tx,ty:g.ty,ta:g.ta,tb:g.tb,tc:g.tc,td:g.td,rtt:l,parentHasRenderTexture:this.parentHasRenderTexture,framebufferDimensions:this.framebufferDimensions})}get id(){return this.props.id}get x(){return this.props.x}set x(e){this.props.x!==e&&(this.props.x=e,this.setUpdateType(Wt.Local))}get absX(){var e,t;return this.props.x+((null===(e=this.props.parent)||void 0===e?void 0:e.absX)||(null===(t=this.props.parent)||void 0===t||null===(t=t.globalTransform)||void 0===t?void 0:t.tx)||0)}get absY(){var e,t;return this.props.y+(null!==(e=null===(t=this.props.parent)||void 0===t?void 0:t.absY)&&void 0!==e?e:0)}get y(){return this.props.y}set y(e){this.props.y!==e&&(this.props.y=e,this.setUpdateType(Wt.Local))}get width(){return this.props.width}set width(e){this.props.width!==e&&(this.props.width=e,this.setUpdateType(Wt.Local),this.props.rtt&&this.setUpdateType(Wt.RenderTexture))}get height(){return this.props.height}set height(e){this.props.height!==e&&(this.props.height=e,this.setUpdateType(Wt.Local),this.props.rtt&&this.setUpdateType(Wt.RenderTexture))}get scale(){return this.scaleX}set scale(e){this.scaleX=e,this.scaleY=e}get scaleX(){return this.props.scaleX}set scaleX(e){this.props.scaleX!==e&&(this.props.scaleX=e,this.setUpdateType(Wt.ScaleRotate))}get scaleY(){return this.props.scaleY}set scaleY(e){this.props.scaleY!==e&&(this.props.scaleY=e,this.setUpdateType(Wt.ScaleRotate))}get mount(){return this.props.mount}set mount(e){this.props.mountX===e&&this.props.mountY===e||(this.props.mountX=e,this.props.mountY=e,this.props.mount=e,this.setUpdateType(Wt.Local))}get mountX(){return this.props.mountX}set mountX(e){this.props.mountX!==e&&(this.props.mountX=e,this.setUpdateType(Wt.Local))}get mountY(){return this.props.mountY}set mountY(e){this.props.mountY!==e&&(this.props.mountY=e,this.setUpdateType(Wt.Local))}get pivot(){return this.props.pivot}set pivot(e){this.props.pivotX===e&&this.props.pivotY===e||(this.props.pivotX=e,this.props.pivotY=e,this.props.pivot=e,this.setUpdateType(Wt.Local))}get pivotX(){return this.props.pivotX}set pivotX(e){this.props.pivotX!==e&&(this.props.pivotX=e,this.setUpdateType(Wt.Local))}get pivotY(){return this.props.pivotY}set pivotY(e){this.props.pivotY!==e&&(this.props.pivotY=e,this.setUpdateType(Wt.Local))}get rotation(){return this.props.rotation}set rotation(e){this.props.rotation!==e&&(this.props.rotation=e,this.setUpdateType(Wt.ScaleRotate))}get alpha(){return this.props.alpha}set alpha(e){this.props.alpha=e,this.setUpdateType(Wt.PremultipliedColors|Wt.WorldAlpha)}get autosize(){return this.props.autosize}set autosize(e){this.props.autosize=e}get clipping(){return this.props.clipping}set clipping(e){this.props.clipping=e,this.setUpdateType(Wt.Clipping)}get color(){return this.props.color}set color(e){this.props.colorTl===e&&this.props.colorTr===e&&this.props.colorBl===e&&this.props.colorBr===e||(this.colorTl=e,this.colorTr=e,this.colorBl=e,this.colorBr=e),this.props.color=e,this.setUpdateType(Wt.PremultipliedColors)}get colorTop(){return this.props.colorTop}set colorTop(e){this.props.colorTl===e&&this.props.colorTr===e||(this.colorTl=e,this.colorTr=e),this.props.colorTop=e,this.setUpdateType(Wt.PremultipliedColors)}get colorBottom(){return this.props.colorBottom}set colorBottom(e){this.props.colorBl===e&&this.props.colorBr===e||(this.colorBl=e,this.colorBr=e),this.props.colorBottom=e,this.setUpdateType(Wt.PremultipliedColors)}get colorLeft(){return this.props.colorLeft}set colorLeft(e){this.props.colorTl===e&&this.props.colorBl===e||(this.colorTl=e,this.colorBl=e),this.props.colorLeft=e,this.setUpdateType(Wt.PremultipliedColors)}get colorRight(){return this.props.colorRight}set colorRight(e){this.props.colorTr===e&&this.props.colorBr===e||(this.colorTr=e,this.colorBr=e),this.props.colorRight=e,this.setUpdateType(Wt.PremultipliedColors)}get colorTl(){return this.props.colorTl}set colorTl(e){this.props.colorTl=e,this.setUpdateType(Wt.PremultipliedColors)}get colorTr(){return this.props.colorTr}set colorTr(e){this.props.colorTr=e,this.setUpdateType(Wt.PremultipliedColors)}get colorBl(){return this.props.colorBl}set colorBl(e){this.props.colorBl=e,this.setUpdateType(Wt.PremultipliedColors)}get colorBr(){return this.props.colorBr}set colorBr(e){this.props.colorBr=e,this.setUpdateType(Wt.PremultipliedColors)}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(e){this.props.zIndexLocked=e,this.setUpdateType(Wt.CalculatedZIndex|Wt.Children),this.children.forEach((e=>{e.setUpdateType(Wt.CalculatedZIndex)}))}get zIndex(){return this.props.zIndex}set zIndex(e){this.props.zIndex=e,this.setUpdateType(Wt.CalculatedZIndex|Wt.Children),this.children.forEach((e=>{e.setUpdateType(Wt.CalculatedZIndex)}))}get parent(){return this.props.parent}set parent(e){var t=this.props.parent;if(t!==e){if(this.props.parent=e,t){var r=t.children.indexOf(this);h(-1!==r,"CoreNode.parent: Node not found in old parent's children!"),t.children.splice(r,1),t.setUpdateType(Wt.Children|Wt.ZIndexSortedChildren)}e&&(e.children.push(this),this.setUpdateType(Wt.All),e.setUpdateType(Wt.Children|Wt.ZIndexSortedChildren),(e.rtt||e.parentHasRenderTexture)&&this.setRTTUpdates(Wt.All)),this.updateScaleRotateTransform()}}get rtt(){return this.props.rtt}set rtt(e){var t,r;e?(this.props.rtt=!0,this.hasRTTupdates=!0,this.setUpdateType(Wt.All),this.children.forEach((e=>{e.setUpdateType(Wt.All)})),null===(t=this.stage.renderer)||void 0===t||t.renderToTexture(this)):this.props.rtt&&(this.props.rtt=!1,this.unloadTexture(),this.setUpdateType(Wt.All),this.children.forEach((e=>{e.parentHasRenderTexture=!1})),null===(r=this.stage.renderer)||void 0===r||r.removeRTTNode(this))}get framebufferDimensions(){return this.parentHasRenderTexture&&!this.rtt&&this.parent?this.parent.framebufferDimensions:{width:this.width,height:this.height}}get parentRenderTexture(){for(var e=this.parent;e;){if(e.rtt)return e;e=e.parent}return null}get texture(){return this.props.texture}setRTTUpdates(e){var t;this.hasRTTupdates=!0,null===(t=this.parent)||void 0===t||t.setRTTUpdates(e)}}var jt=1;function Gt(){return jt++}class Vt extends u{constructor(e,t,r,i){var n;super(),d(this,"rendererMain",void 0),d(this,"stage",void 0),d(this,"id",void 0),d(this,"coreNode",void 0),d(this,"_children",[]),d(this,"_src",""),d(this,"_parent",null),d(this,"_texture",null),d(this,"_shader",null),d(this,"_data",{}),d(this,"onTextureLoaded",((e,t)=>{this.emit("loaded",t)})),d(this,"onTextureFailed",((e,t)=>{this.emit("failed",t)})),d(this,"onTextureFreed",((e,t)=>{this.emit("freed",t)})),d(this,"onOutOfBounds",((e,t)=>{this.emit("outOfBounds",t)})),d(this,"onInBounds",((e,t)=>{this.emit("inBounds",t)})),d(this,"onOutOfViewport",((e,t)=>{this.emit("outOfViewport",t)})),d(this,"onInViewport",((e,t)=>{this.emit("inViewport",t)})),this.rendererMain=t,this.stage=r,this.id=null!==(n=null==i?void 0:i.id)&&void 0!==n?n:Gt(),this.coreNode=i||new Xt(this.stage,{id:this.id,x:e.x,y:e.y,width:e.width,height:e.height,alpha:e.alpha,autosize:e.autosize,clipping:e.clipping,color:e.color,colorTop:e.colorTop,colorBottom:e.colorBottom,colorLeft:e.colorLeft,colorRight:e.colorRight,colorTl:e.colorTl,colorTr:e.colorTr,colorBl:e.colorBl,colorBr:e.colorBr,zIndex:e.zIndex,zIndexLocked:e.zIndexLocked,scaleX:e.scaleX,scaleY:e.scaleY,mountX:e.mountX,mountY:e.mountY,mount:e.mount,pivot:e.pivot,pivotX:e.pivotX,pivotY:e.pivotY,rotation:e.rotation,parent:null,shader:null,shaderProps:null,texture:null,textureOptions:null,rtt:e.rtt}),this.coreNode.on("loaded",this.onTextureLoaded),this.coreNode.on("failed",this.onTextureFailed),this.coreNode.on("freed",this.onTextureFreed),this.coreNode.on("outOfBounds",this.onOutOfBounds),this.coreNode.on("inBounds",this.onInBounds),this.coreNode.on("outOfViewport",this.onOutOfViewport),this.coreNode.on("inViewport",this.onInViewport),this.parent=e.parent,this.shader=e.shader,this.texture=e.texture,this.src=e.src,this.rtt=e.rtt,this._data=e.data}get x(){return this.coreNode.x}set x(e){this.coreNode.x=e}get y(){return this.coreNode.y}set y(e){this.coreNode.y=e}get width(){return this.coreNode.width}set width(e){e!==this.coreNode.width&&this.coreNode.rtt&&(this.texture=this.rendererMain.createTexture("RenderTexture",{width:this.width,height:this.height},{preload:!0,flipY:!0})),this.coreNode.width=e}get height(){return this.coreNode.height}set height(e){e!==this.coreNode.height&&this.coreNode.rtt&&(this.texture=this.rendererMain.createTexture("RenderTexture",{width:this.width,height:this.height},{preload:!0,flipY:!0})),this.coreNode.height=e}get alpha(){return this.coreNode.alpha}set alpha(e){this.coreNode.alpha=e}get autosize(){return this.coreNode.autosize}set autosize(e){this.coreNode.autosize=e}get clipping(){return this.coreNode.clipping}set clipping(e){this.coreNode.clipping=e}get color(){return this.coreNode.color}set color(e){this.coreNode.color=e}get colorTop(){return this.coreNode.colorTop}set colorTop(e){this.coreNode.colorTop=e}get colorBottom(){return this.coreNode.colorBottom}set colorBottom(e){this.coreNode.colorBottom=e}get colorLeft(){return this.coreNode.colorLeft}set colorLeft(e){this.coreNode.colorLeft=e}get colorRight(){return this.coreNode.colorRight}set colorRight(e){this.coreNode.colorRight=e}get colorTl(){return this.coreNode.colorTl}set colorTl(e){this.coreNode.colorTl=e}get colorTr(){return this.coreNode.colorTr}set colorTr(e){this.coreNode.colorTr=e}get colorBl(){return this.coreNode.colorBl}set colorBl(e){this.coreNode.colorBl=e}get colorBr(){return this.coreNode.colorBr}set colorBr(e){this.coreNode.colorBr=e}get scale(){return this.scaleX!==this.scaleY?null:this.coreNode.scaleX}set scale(e){null!==e&&(this.coreNode.scaleX=e,this.coreNode.scaleY=e)}get scaleX(){return this.coreNode.scaleX}set scaleX(e){this.coreNode.scaleX=e}get scaleY(){return this.coreNode.scaleY}set scaleY(e){this.coreNode.scaleY=e}get mount(){return this.coreNode.mount}set mount(e){this.coreNode.mount=e}get mountX(){return this.coreNode.mountX}set mountX(e){this.coreNode.mountX=e}get mountY(){return this.coreNode.mountY}set mountY(e){this.coreNode.mountY=e}get pivot(){return this.coreNode.pivot}set pivot(e){this.coreNode.pivot=e}get pivotX(){return this.coreNode.pivotX}set pivotX(e){this.coreNode.pivotX=e}get pivotY(){return this.coreNode.pivotY}set pivotY(e){this.coreNode.pivotY=e}get rotation(){return this.coreNode.rotation}set rotation(e){this.coreNode.rotation=e}get parent(){return this._parent}set parent(e){var t,r=this._parent;if(this._parent=e,this.coreNode.parent=null!==(t=null==e?void 0:e.coreNode)&&void 0!==t?t:null,r){var i=r.children.indexOf(this);h(-1!==i,"MainOnlyNode.parent: Node not found in old parent's children!"),r.children.splice(i,1)}e&&e.children.push(this)}get children(){return this._children}get zIndex(){return this.coreNode.zIndex}set zIndex(e){this.coreNode.zIndex=e}get zIndexLocked(){return this.coreNode.zIndexLocked}set zIndexLocked(e){this.coreNode.zIndexLocked=e}get src(){return this._src}set src(e){this._src!==e&&(this._src=e,this.texture=e?this.rendererMain.createTexture("ImageTexture",{src:e}):null)}get texture(){return this._texture}set texture(e){this._texture!==e&&(this._texture&&this.rendererMain.textureTracker.decrementTextureRefCount(this._texture),e&&this.rendererMain.textureTracker.incrementTextureRefCount(e),this._texture=e,e?this.coreNode.loadTexture(e.txType,e.props,e.options):this.coreNode.unloadTexture())}get rtt(){return this.coreNode.rtt}set rtt(e){e&&(this.texture=this.rendererMain.createTexture("RenderTexture",{width:this.width,height:this.height},{preload:!0,flipY:!0})),this.coreNode.rtt=e}get parentHasRenderTexture(){return this.coreNode.parentHasRenderTexture}get shader(){return this._shader}set shader(e){this._shader!==e&&(this._shader=e,e&&this.coreNode.loadShader(e.shType,e.props))}get data(){return this._data}set data(e){this._data=At(e)}destroy(){this.emit("beforeDestroy",{});for(var e=this.children[0];e;)e.destroy(),e=this.children[0];this.coreNode.destroy(),this.parent=null,this.texture=null,this.emit("afterDestroy",{}),this.removeAllListeners()}flush(){}animate(e,t){var r=new Pt(this.coreNode,e,t);return new Ot(this.stage.animationManager,r)}}class Kt{constructor(){d(this,"activeAnimations",new Set)}registerAnimation(e){this.activeAnimations.add(e)}unregisterAnimation(e){this.activeAnimations.delete(e)}update(e){this.activeAnimations.forEach((t=>{t.update(e)}))}}class qt{constructor(e){d(this,"imageWorkersEnabled",!0),d(this,"messageManager",{}),d(this,"workers",[]),d(this,"workerIndex",0),d(this,"nextId",0),this.workers=this.createWorkers(e),this.workers.forEach((e=>{e.onmessage=this.handleMessage.bind(this)}))}handleMessage(t){var r=t.data,i=r.id,n=r.data,o=r.error,s=this.messageManager[i];if(s){var a=e(s,2),l=a[0],d=a[1];delete this.messageManager[i],o?d(new Error(o)):l(n)}}createWorkers(e=1){for(var t=new Blob(["\n      function hasAlphaChannel(mimeType) {\n          return (mimeType.indexOf(\"image/png\") !== -1);\n      }\n\n      function getImage(src, premultiplyAlpha) {\n        return new Promise(function(resolve, reject) {\n          var xhr = new XMLHttpRequest();\n          xhr.open('GET', src, true);\n          xhr.responseType = 'blob';\n\n          xhr.onload = function() {\n            if (xhr.status === 200) {\n              var blob = xhr.response;\n              var hasAlphaChannel = premultiplyAlpha !== undefined ? premultiplyAlpha : hasAlphaChannel(blob.type);\n\n              createImageBitmap(blob, {\n                premultiplyAlpha: hasAlphaChannel ? 'premultiply' : 'none',\n                colorSpaceConversion: 'none',\n                imageOrientation: 'none'\n              }).then(function(data) {\n                resolve({ data: data, premultiplyAlpha: premultiplyAlpha });\n              }).catch(function(error) {\n                reject(error);\n              });\n            } else {\n              reject(new Error('Failed to load image: ' + xhr.statusText));\n            }\n          };\n\n          xhr.onerror = function() {\n            reject(new Error('Network error occurred while trying to fetch the image.'));\n          };\n\n          xhr.send();\n        });\n      }\n\n      self.onmessage = (event) => {\n        var id = event.data.id;\n        var src = event.data.src;\n        var premultiplyAlpha = event.data.premultiplyAlpha;\n\n        getImage(src, premultiplyAlpha)\n          .then(function(data) {\n              self.postMessage({ id: id, data: data }, [data.data]);\n          })\n          .catch(function(error) {\n              self.postMessage({ id: id, error: error.message });\n          });\n      };\n    ".replace('"use strict";',"")],{type:"application/javascript"}),r=(self.URL?URL:webkitURL).createObjectURL(t),i=[],n=0;n<e;n++)i.push(new Worker(r));return i}getNextWorker(){var e=this.workers[this.workerIndex];return this.workerIndex=(this.workerIndex+1)%this.workers.length,e}convertUrlToAbsolute(e){return new URL(e,self.location.href).href}getImage(e,t){return new Promise(((r,i)=>{try{if(this.workers){var n=this.convertUrlToAbsolute(e),o=this.nextId++;this.messageManager[o]=[r,i],this.getNextWorker().postMessage({id:o,src:n,premultiplyAlpha:t})}}catch(s){i(s)}}))}}class Qt extends w{constructor(e,t){super(e),d(this,"props",void 0),this.props=Qt.resolveDefaults(t)}getTextureData(){var e=this;return i(t().mark((function r(){var i,n,o,s,a,l,d;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:for(i=e.props,n=i.width,o=i.height,s=n*o*4,a=new Uint8ClampedArray(s),l=0;l<s;l+=4)d=Math.floor(256*Math.random()),a[l]=d,a[l+1]=d,a[l+2]=d,a[l+3]=255;return t.abrupt("return",{data:new ImageData(a,n,o)});case 5:case"end":return t.stop()}}),r)})))()}static makeCacheKey(e){var t=Qt.resolveDefaults(e);return`NoiseTexture,${t.width},${t.height},${t.cacheId}`}static resolveDefaults(e){var t,r,i;return{width:null!==(t=e.width)&&void 0!==t?t:128,height:null!==(r=e.height)&&void 0!==r?r:128,cacheId:null!==(i=e.cacheId)&&void 0!==i?i:0}}}d(Qt,"z$__type__Props",void 0);class Zt{constructor(e){d(this,"usedMemory",0),d(this,"txConstructors",{}),d(this,"textureKeyCache",new Map),d(this,"textureIdCache",new Map),d(this,"ctxTextureCache",new WeakMap),d(this,"textureRefCountMap",new WeakMap),d(this,"imageWorkerManager",null),d(this,"hasCreateImageBitmap",!!self.createImageBitmap),d(this,"hasWorker",!!self.Worker),d(this,"renderer",void 0),this.hasCreateImageBitmap&&this.hasWorker&&(this.imageWorkerManager=new qt(e)),this.hasCreateImageBitmap||console.warn("[Lightning] createImageBitmap is not supported on this browser. ImageTexture will be slower."),this.registerTextureType("ImageTexture",Me),this.registerTextureType("ColorTexture",A),this.registerTextureType("NoiseTexture",Qt),this.registerTextureType("SubTexture",z),this.registerTextureType("RenderTexture",P)}registerTextureType(e,t){this.txConstructors[e]=t}loadTexture(e,t,r=null){var i,n=this.txConstructors[e];if(!n)throw new Error(`Texture type "${e}" is not registered`);if(void 0!==(null==r?void 0:r.id)&&this.textureIdCache.has(r.id)&&(i=this.textureIdCache.get(r.id)),!i){var o,s=null==r?void 0:r.id,a=null!==(o=null==r?void 0:r.cacheKey)&&void 0!==o?o:n.makeCacheKey(t);i=a&&this.textureKeyCache.has(a)?this.textureKeyCache.get(a):new n(this,t),s&&this.addTextureIdToCache(s,a,i)}null!=r&&r.preload&&this.getCtxTexture(i).load();return i}addTextureIdToCache(e,t,r){var i=this.textureIdCache,n=this.textureRefCountMap;i.set(e,r),n.has(r)?n.get(r).count++:(n.set(r,{cacheKey:t,count:1}),t&&this.textureKeyCache.set(t,r))}removeTextureIdFromCache(e){var t,r=this.textureIdCache,i=this.textureRefCountMap,n=r.get(e);if(n){if(r.delete(e),i.has(n)){var o=i.get(n);h(o),o.count--,0===o.count&&(i.delete(n),o.cacheKey&&this.textureKeyCache.delete(o.cacheKey))}null===(t=this.ctxTextureCache.get(n))||void 0===t||t.free()}}getDebugInfo(){return{keyCacheSize:this.textureKeyCache.size,idCacheSize:this.textureIdCache.size}}getCtxTexture(e){if(this.ctxTextureCache.has(e))return this.ctxTextureCache.get(e);var t=this.renderer.createCtxTexture(e);return this.ctxTextureCache.set(e,t),t}}class Jt{constructor(){d(this,"data",{})}reset(){this.data={}}increment(e){this.data[e]||(this.data[e]=0),this.data[e]++}getData(){return l({},this.data)}}class er{constructor(e){d(this,"memUsed",0),d(this,"textures",new Map),d(this,"threshold",void 0),d(this,"gcRequested",!1),this.threshold=e,0===e&&(this.setTextureMemUse=()=>{})}setTextureMemUse(e,t){this.textures.has(e)&&(this.memUsed-=this.textures.get(e)),0!==t?(this.memUsed+=t,this.textures.set(e,t),this.memUsed>this.threshold&&(this.gcRequested=!0)):this.textures.delete(e)}gc(){this.gcRequested=!1,this.textures.forEach(((e,t)=>{t.renderable||t.free()}))}}var tr={isWhite:!0,a:1,r:255,g:255,b:255};function rr(e){return 4294967295===e?tr:{isWhite:!1,a:(e>>>24&255)/255,r:255&e,g:255&e>>>8,b:255&e>>>16}}function ir({a:e,r:t,g:r,b:i}){return`rgba(${t},${r},${i},${e})`}class nr extends O{constructor(...e){super(...e),d(this,"image",void 0),d(this,"tintCache",void 0)}load(){"freed"===this.textureSource.state&&(this.textureSource.setState("loading"),this.onLoadRequest().then((e=>{this.textureSource.setState("loaded",e),this.updateMemSize()})).catch((e=>{this.textureSource.setState("failed",e)})))}free(){this.image=void 0,this.tintCache=void 0,this.textureSource.setState("freed"),this.memManager.setTextureMemUse(this,0)}updateMemSize(){var e=this.tintCache?8:4;if(this.textureSource.dimensions){var t=this.textureSource.dimensions,r=t.width,i=t.height;this.memManager.setTextureMemUse(this,r*i*e)}}hasImage(){return void 0!==this.image}getImage(e){var t,r=this.image;if(h(r,"Attempt to get unloaded image texture"),e.isWhite)return this.tintCache&&(this.tintCache=void 0,this.updateMemSize()),r;var i=ir(e);if((null===(t=this.tintCache)||void 0===t?void 0:t.key)===i)return this.tintCache.image;var n=this.tintTexture(r,i);return this.tintCache={key:i,image:n},this.updateMemSize(),n}tintTexture(e,t){var r=e.width,i=e.height,n=document.createElement("canvas");n.width=r,n.height=i;var o=n.getContext("2d");return o&&(o.fillStyle=t,o.globalCompositeOperation="copy",o.fillRect(0,0,r,i),o.globalCompositeOperation="multiply",o.drawImage(e,0,0,r,i,0,0,r,i),o.globalCompositeOperation="destination-in",o.drawImage(e,0,0,r,i,0,0,r,i)),n}get renderable(){return this.textureSource.renderable}onLoadRequest(){var e=this;return i(t().mark((function r(){var i,n,o,s;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.textureSource.getTextureData();case 2:if(i=t.sent,!((n=i.data)instanceof ImageData)){t.next=14;break}return(o=document.createElement("canvas")).width=n.width,o.height=n.height,(s=o.getContext("2d"))&&s.putImageData(n,0,0),e.image=o,t.abrupt("return",{width:n.width,height:n.height});case 14:if(!(n instanceof ImageBitmap)){t.next=17;break}return e.image=n,t.abrupt("return",{width:n.width,height:n.height});case 17:return t.abrupt("return",{width:0,height:0});case 18:case"end":return t.stop()}}),r)})))()}}class or extends ${constructor(e){super(e),d(this,"context",void 0),d(this,"canvas",void 0),d(this,"pixelRatio",void 0),d(this,"clearColor",void 0),d(this,"renderToTextureActive",!1),d(this,"activeRttNode",null),this.mode="canvas",this.shManager.renderer=this;var t=e.canvas,r=e.pixelRatio,i=e.clearColor;this.canvas=t,this.context=t.getContext("2d"),this.pixelRatio=r,this.clearColor=i?D(i):void 0}reset(){this.canvas.width=this.canvas.width;var t=this.context;if(this.clearColor){var r=e(this.clearColor,4),i=r[0],n=r[1],o=r[2],s=r[3];t.fillStyle=`rgba(${i}, ${n}, ${o}, ${s/255})`,t.fillRect(0,0,this.canvas.width,this.canvas.height)}t.scale(this.pixelRatio,this.pixelRatio)}render(){}addQuad(e){var t,r=this.context,i=e.tx,n=e.ty,o=e.width,s=e.height,a=e.alpha,l=e.colorTl,d=e.colorTr,h=e.colorBr,u=e.ta,c=e.tb,p=e.tc,f=e.td,v=e.clippingRect,g=e.texture,m=void 0;if(g){if(g instanceof z&&(t=g.props,g=g.parentTexture),m=this.txManager.getCtxTexture(g),"freed"===g.state)return void m.load();if("loaded"!==g.state||!m.hasImage())return}var x=rr(l),y=1!==u,w=0!==v.width&&0!==v.height,b=l!==d||l!==h,_=e.shader?function(e){var t,r;return e.shader instanceof Ce&&e.shader.shType===Se&&null!==(t=null===(r=e.shaderProps)||void 0===r?void 0:r.radius)&&void 0!==t?t:0}(e):0;if((y||w||_)&&r.save(),w){var T=new Path2D,S=v.x,C=v.y,R=v.width,I=v.height;T.rect(S,C,R,I),r.clip(T)}if(y){var N=this.pixelRatio;r.setTransform(u,p,c,f,i*N,n*N),r.scale(N,N),r.translate(-i,-n)}if(_){var L=new Path2D;L.roundRect(i,n,o,s,_),r.clip(L)}if(m){var M=m.getImage(x);r.globalAlpha=a,t?r.drawImage(M,t.x,t.y,t.width,t.height,i,n,o,s):r.drawImage(M,i,n,o,s),r.globalAlpha=1}else if(b){var k,B=i,F=n;l===d?(B=i,F=n+s,k=rr(h)):(B=i+o,F=n,k=rr(d));var E=r.createLinearGradient(i,n,B,F);E.addColorStop(0,ir(x)),E.addColorStop(1,ir(k)),r.fillStyle=E,r.fillRect(i,n,o,s)}else r.fillStyle=ir(x),r.fillRect(i,n,o,s);(y||w||_)&&r.restore()}createCtxTexture(e){return new nr(this.txMemManager,e)}getShaderManager(){return this.shManager}renderRTTNodes(){}removeRTTNode(e){}renderToTexture(e){}}var sr,ar;class lr extends u{constructor(e){super(),d(this,"options",void 0),d(this,"animationManager",void 0),d(this,"txManager",void 0),d(this,"txMemManager",void 0),d(this,"fontManager",void 0),d(this,"textRenderers",void 0),d(this,"shManager",void 0),d(this,"renderer",void 0),d(this,"root",void 0),d(this,"boundsMargin",void 0),d(this,"deltaTime",0),d(this,"lastFrameTime",0),d(this,"currentFrameTime",0),d(this,"fpsNumFrames",0),d(this,"fpsElapsedTime",0),d(this,"renderRequested",!1),d(this,"contextSpy",null),this.options=e;var t=e.canvas,r=e.clearColor,i=e.rootId,n=e.debug,o=e.appWidth,s=e.appHeight,a=e.boundsMargin,l=e.enableContextSpy,u=e.numImageWorkers,c=e.txMemByteThreshold,p=e.renderMode;this.txManager=new Zt(u),this.txMemManager=new er(c),this.shManager=new Re,this.animationManager=new Kt,this.contextSpy=l?new Jt:null;var f=[0,0,0,0];a&&(f=Array.isArray(a)?a:[a,a,a,a]),this.boundsMargin=f,null!=n&&n.monitorTextureCache&&setInterval((()=>{h(this.txManager);var e=this.txManager.getDebugInfo();console.log("Texture ID Cache Size: ",e.idCacheSize),console.log("Texture Key Cache Size: ",e.keyCacheSize)}),1e3);var v={stage:this,canvas:t,pixelRatio:e.devicePhysicalPixelRatio*e.deviceLogicalPixelRatio,clearColor:null!=r?r:4278190080,bufferMemory:2e6,txManager:this.txManager,txMemManager:this.txMemManager,shManager:this.shManager,contextSpy:this.contextSpy};this.renderer="canvas"===p?new or(v):new S(v),Y(p),this.txManager.renderer=this.renderer,this.textRenderers="webgl"===p?{canvas:new te(this),sdf:new De(this)}:{canvas:new te(this)},this.fontManager=new Oe(this.textRenderers);var g,m,x,y=new Xt(this,{id:i,x:0,y:0,width:o,height:s,alpha:1,autosize:!1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null,rtt:!1});this.root=y,g=this,m=!1,x=()=>{if(g.updateAnimations(),!g.hasSceneUpdates())return g.calculateFps(),setTimeout(x,16.666666666666668),void(m||(g.emit("idle"),m=!0));m=!1,g.drawFrame(),requestAnimationFrame(x)},requestAnimationFrame(x)}updateAnimations(){var e=this.animationManager;this.root&&(this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=performance?performance.now():Date.now(),this.deltaTime=this.lastFrameTime?this.currentFrameTime-this.lastFrameTime:100/6,this.emit("frameTick",{time:this.currentFrameTime,delta:this.deltaTime}),e.update(this.deltaTime))}hasSceneUpdates(){return!!this.root.updateType||this.renderRequested}drawFrame(){var e=this.renderer,t=this.renderRequested;h(e),0!==this.root.updateType&&this.root.update(this.deltaTime,this.root.clippingRect),e.reset(),e.txMemManager.gcRequested&&e.txMemManager.gc(),e.rttNodes.length>0&&e.renderRTTNodes(),this.addQuads(this.root),null==e||e.render(),this.calculateFps(),t&&(this.renderRequested=!1)}calculateFps(){var e=this.options.fpsUpdateInterval;if(e&&(this.fpsNumFrames++,this.fpsElapsedTime+=this.deltaTime,this.fpsElapsedTime>=e)){var t,r,i,n=Math.round(1e3*this.fpsNumFrames/this.fpsElapsedTime);this.fpsNumFrames=0,this.fpsElapsedTime=0,this.emit("fpsUpdate",{fps:n,contextSpyData:null!==(t=null===(r=this.contextSpy)||void 0===r?void 0:r.getData())&&void 0!==t?t:null}),null===(i=this.contextSpy)||void 0===i||i.reset()}}addQuads(e){h(this.renderer&&e.globalTransform),e.isRenderable&&e.renderQuads(this.renderer);for(var t=0;t<e.children.length;t++){var r=e.children[t];r&&(0!==(null==r?void 0:r.worldAlpha)&&this.addQuads(r))}}requestRender(){this.renderRequested=!0}resolveTextRenderer(t,r=null){var i=r,n=!1;if(i){var o=this.textRenderers[i];o?o.canRenderFont(t)||(console.warn(`Cannot use override text renderer '${i}' for font`,t),i=null,n=!0):(console.warn(`Text renderer override '${i}' not found.`),i=null,n=!0)}if(!i){for(var s=0,a=Object.entries(this.textRenderers);s<a.length;s++){var l=e(a[s],2),d=l[0],u=l[1];if("canvas"!==d&&u.canRenderFont(t)){i=d;break}}i||(i="canvas")}n&&console.warn(`Falling back to text renderer ${String(i)}`);var c=this.textRenderers[i];return h(c,"resolvedTextRenderer undefined"),c}}class dr extends Xt{constructor(e,t){super(e,t),d(this,"textRenderer",void 0),d(this,"trState",void 0),d(this,"_textRendererOverride",null),d(this,"onTextLoaded",(()=>{var e=this.contain,t=this.trState.props.width,r=this.trState.props.height,i=this.trState.textW||0,n=this.trState.textH||0;"both"===e?(this.props.width=t,this.props.height=r):"width"===e?(this.props.width=t,this.props.height=n):"none"===e&&(this.props.width=i,this.props.height=n),this.updateLocalTransform(),this.stage.requestRender(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})})),d(this,"onTextFailed",((e,t)=>{this.emit("failed",{type:"text",error:t})})),this._textRendererOverride=t.textRendererOverride;var r=this.resolveTextRendererAndState({x:this.absX,y:this.absY,width:t.width,height:t.height,textAlign:t.textAlign,color:t.color,zIndex:t.zIndex,contain:t.contain,scrollable:t.scrollable,scrollY:t.scrollY,offsetY:t.offsetY,letterSpacing:t.letterSpacing,debug:t.debug,fontFamily:t.fontFamily,fontSize:t.fontSize,fontStretch:t.fontStretch,fontStyle:t.fontStyle,fontWeight:t.fontWeight,text:t.text,lineHeight:t.lineHeight,maxLines:t.maxLines,textBaseline:t.textBaseline,verticalAlign:t.verticalAlign,overflowSuffix:t.overflowSuffix}),i=r.resolvedTextRenderer,n=r.textRendererState;this.textRenderer=i,this.trState=n}get width(){return this.props.width}set width(e){this.props.width=e,this.textRenderer.set.width(this.trState,e),"none"===this.contain&&this.setUpdateType(Wt.Local)}get height(){return this.props.height}set height(e){this.props.height=e,this.textRenderer.set.height(this.trState,e),"both"!==this.contain&&this.setUpdateType(Wt.Local)}get color(){return this.trState.props.color}set color(e){this.textRenderer.set.color(this.trState,e)}get text(){return this.trState.props.text}set text(e){this.textRenderer.set.text(this.trState,e)}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(e){this._textRendererOverride=e,this.textRenderer.destroyState(this.trState);var t=this.resolveTextRendererAndState(this.trState.props),r=t.resolvedTextRenderer,i=t.textRendererState;this.textRenderer=r,this.trState=i}get fontSize(){return this.trState.props.fontSize}set fontSize(e){this.textRenderer.set.fontSize(this.trState,e)}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(e){this.textRenderer.set.fontFamily(this.trState,e)}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(e){this.textRenderer.set.fontStretch(this.trState,e)}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(e){this.textRenderer.set.fontStyle(this.trState,e)}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(e){this.textRenderer.set.fontWeight(this.trState,e)}get textAlign(){return this.trState.props.textAlign}set textAlign(e){this.textRenderer.set.textAlign(this.trState,e)}get contain(){return this.trState.props.contain}set contain(e){this.textRenderer.set.contain(this.trState,e)}get scrollable(){return this.trState.props.scrollable}set scrollable(e){this.textRenderer.set.scrollable(this.trState,e)}get scrollY(){return this.trState.props.scrollY}set scrollY(e){this.textRenderer.set.scrollY(this.trState,e)}get offsetY(){return this.trState.props.offsetY}set offsetY(e){this.textRenderer.set.offsetY(this.trState,e)}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(e){this.textRenderer.set.letterSpacing(this.trState,e)}get lineHeight(){return this.trState.props.lineHeight}set lineHeight(e){this.textRenderer.set.lineHeight&&this.textRenderer.set.lineHeight(this.trState,e)}get maxLines(){return this.trState.props.maxLines}set maxLines(e){this.textRenderer.set.maxLines&&this.textRenderer.set.maxLines(this.trState,e)}get textBaseline(){return this.trState.props.textBaseline}set textBaseline(e){this.textRenderer.set.textBaseline&&this.textRenderer.set.textBaseline(this.trState,e)}get verticalAlign(){return this.trState.props.verticalAlign}set verticalAlign(e){this.textRenderer.set.verticalAlign&&this.textRenderer.set.verticalAlign(this.trState,e)}get overflowSuffix(){return this.trState.props.overflowSuffix}set overflowSuffix(e){this.textRenderer.set.overflowSuffix&&this.textRenderer.set.overflowSuffix(this.trState,e)}get debug(){return this.trState.props.debug}set debug(e){this.textRenderer.set.debug(this.trState,e)}update(e,t){super.update(e,t),h(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty)}checkRenderProps(){return""!==this.trState.props.text||super.checkRenderProps()}onChangeIsRenderable(e){super.onChangeIsRenderable(e),this.textRenderer.setIsRenderable(this.trState,e)}renderQuads(e){var t;if(h(this.globalTransform),this.parentHasRenderTexture){if(!e.renderToTextureActive)return;if(this.parentRenderTexture!==e.activeRttNode)return}this.parentHasRenderTexture&&null!==(t=this.props.parent)&&void 0!==t&&t.rtt&&(this.globalTransform=$t.identity(),this.localTransform&&this.globalTransform.multiply(this.localTransform)),h(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,this.clippingRect,this.worldAlpha,this.parentHasRenderTexture,this.framebufferDimensions)}destroy(){super.destroy(),this.textRenderer.destroyState(this.trState)}resolveTextRendererAndState(e){var t=this.stage.resolveTextRenderer(e,this._textRendererOverride),r=t.createState(e);return r.emitter.on("loaded",this.onTextLoaded),r.emitter.on("failed",this.onTextFailed),t.scheduleUpdateState(r),{resolvedTextRenderer:t,textRendererState:r}}}class hr extends Vt{constructor(e,t,r){super(e,t,r,new dr(r,{id:Gt(),x:e.x,y:e.y,width:e.width,height:e.height,alpha:e.alpha,autosize:e.autosize,clipping:e.clipping,color:e.color,colorTop:e.colorTop,colorBottom:e.colorBottom,colorLeft:e.colorLeft,colorRight:e.colorRight,colorTl:e.colorTl,colorTr:e.colorTr,colorBl:e.colorBl,colorBr:e.colorBr,zIndex:e.zIndex,zIndexLocked:e.zIndexLocked,scaleX:e.scaleX,scaleY:e.scaleY,mountX:e.mountX,mountY:e.mountY,mount:e.mount,pivot:e.pivot,pivotX:e.pivotX,pivotY:e.pivotY,rotation:e.rotation,text:e.text,fontSize:e.fontSize,fontFamily:e.fontFamily,fontWeight:e.fontWeight,fontStretch:e.fontStretch,fontStyle:e.fontStyle,contain:e.contain,scrollable:e.scrollable,letterSpacing:e.letterSpacing,textAlign:e.textAlign,scrollY:e.scrollY,offsetY:e.offsetY,textRendererOverride:e.textRendererOverride,lineHeight:e.lineHeight,maxLines:e.maxLines,textBaseline:e.textBaseline,verticalAlign:e.verticalAlign,overflowSuffix:e.overflowSuffix,debug:e.debug,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null,rtt:!1}))}get text(){return this.coreNode.text}set text(e){this.coreNode.text=e}get textRendererOverride(){return this.coreNode.textRendererOverride}set textRendererOverride(e){this.coreNode.textRendererOverride=e}get fontSize(){return this.coreNode.fontSize}set fontSize(e){this.coreNode.fontSize=e}get fontFamily(){return this.coreNode.fontFamily}set fontFamily(e){this.coreNode.fontFamily=e}get fontWeight(){return this.coreNode.fontWeight}set fontWeight(e){this.coreNode.fontWeight=e}get fontStretch(){return this.coreNode.fontStretch}set fontStretch(e){this.coreNode.fontStretch=e}get fontStyle(){return this.coreNode.fontStyle}set fontStyle(e){this.coreNode.fontStyle=e}get textAlign(){return this.coreNode.textAlign}set textAlign(e){this.coreNode.textAlign=e}get contain(){return this.coreNode.contain}set contain(e){this.coreNode.contain=e}get scrollable(){return this.coreNode.scrollable}set scrollable(e){this.coreNode.scrollable=e}get scrollY(){return this.coreNode.scrollY}set scrollY(e){this.coreNode.scrollY=e}get offsetY(){return this.coreNode.offsetY}set offsetY(e){this.coreNode.offsetY=e}get letterSpacing(){return this.coreNode.letterSpacing}set letterSpacing(e){this.coreNode.letterSpacing=e}get lineHeight(){return this.coreNode.lineHeight}set lineHeight(e){e&&(this.coreNode.lineHeight=e)}get maxLines(){return this.coreNode.maxLines}set maxLines(e){e&&(this.coreNode.maxLines=e)}get textBaseline(){return this.coreNode.textBaseline}set textBaseline(e){e&&(this.coreNode.textBaseline=e)}get verticalAlign(){return this.coreNode.verticalAlign}set verticalAlign(e){e&&(this.coreNode.verticalAlign=e)}get overflowSuffix(){return this.coreNode.overflowSuffix}set overflowSuffix(e){e&&(this.coreNode.overflowSuffix=e)}get debug(){return this.coreNode.debug}set debug(e){this.coreNode.debug=e}}class ur{constructor(){d(this,"root",null),d(this,"stage",null),d(this,"rendererMain",null)}init(e,r,n){var o=this;return i(t().mark((function i(){var s;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(o.stage=new lr({rootId:Gt(),appWidth:r.appWidth,appHeight:r.appHeight,txMemByteThreshold:r.txMemByteThreshold,boundsMargin:r.boundsMargin,deviceLogicalPixelRatio:r.deviceLogicalPixelRatio,devicePhysicalPixelRatio:r.devicePhysicalPixelRatio,clearColor:r.clearColor,canvas:n,fpsUpdateInterval:r.fpsUpdateInterval,enableContextSpy:r.enableContextSpy,numImageWorkers:r.numImageWorkers,renderMode:r.renderMode,debug:{monitorTextureCache:!1}}),o.rendererMain=e,h(o.stage.root),s=new Vt(e.resolveNodeDefaults({}),o.rendererMain,o.stage,o.stage.root),o.root=s,s.once("beforeDestroy",o.onBeforeDestroyNode.bind(o,s)),o.onCreateNode(s),!r.coreExtensionModule){t.next=10;break}return t.next=10,Ft(r.coreExtensionModule,o.stage);case 10:o.stage.on("fpsUpdate",((e,t)=>{o.onFpsUpdate(t)})),o.stage.on("frameTick",((e,t)=>{o.onFrameTick(t)})),o.stage.on("idle",(()=>{o.onIdle()}));case 13:case"end":return t.stop()}}),i)})))()}createNode(e){h(this.rendererMain),h(this.stage);var t=new Vt(e,this.rendererMain,this.stage);return t.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,t)),this.onCreateNode(t),t}createTextNode(e){h(this.rendererMain),h(this.stage);var t=new hr(e,this.rendererMain,this.stage);return t.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,t)),this.onCreateNode(t),t}destroyNode(e){e.destroy()}releaseTexture(e){var t=this.stage;h(t),t.txManager.removeTextureIdFromCache(e)}getRootNode(){return h(this.root),this.root}onCreateNode(e){throw new Error("Method not implemented.")}onBeforeDestroyNode(e){throw new Error("Method not implemented.")}onFpsUpdate(e){throw new Error("Method not implemented.")}onFrameTick(e){throw new Error("Method not implemented.")}onIdle(){throw new Error("Method not implemented.")}}function cr(e={},t="app"){var r=new ur;return sr=new zt(e,t,r),ar=sr.createShader.bind(sr),sr}class pr extends Array{constructor(e){super(),this._parent=e}get selected(){return this[this._parent.selected||0]}get firstChild(){return this[0]}insert(e,t){if(t){var r=this.indexOf(t);this.splice(r,0,e)}else this.push(e);e.parent=this._parent}remove(e){var t=this.indexOf(e);t>=0&&this.splice(t,1)}}var fr={debug:!1,animationsEnabled:!0,animationSettings:{duration:250,easing:"ease-in-out"},fontSettings:{fontFamily:"Ubuntu",fontSize:100}};function vr(e,t,...r){false}function gr(e){return"function"==typeof e}function mr(e){return Array.isArray(e)}function xr(e,t={}){if(mr(e))e.forEach((e=>{xr(e,t)}));else if(e)for(var r in e)void 0===t[r]&&(t[r]=e[r]);return t}class yr extends Array{constructor(e,t={}){return mr(t)?super(...t):"string"==typeof t?super(t):super(...Object.entries(t).filter((([e,t])=>t)).map((([e])=>e))),this.onChange=e,this}has(e){return this.indexOf(e)>=0}is(e){return this.indexOf(e)>=0}add(e){this.push(e),this.onChange()}toggle(e){this.has(e)?this.remove(e):this.add(e)}remove(e){var t=this.indexOf(e);t>=0&&(this.splice(t,1),this.onChange())}}var wr=fr.animationSettings,br=[],_r=!0;function Tr(t){for(var r=[],i=0,n=Object.entries(t);i<n.length;i++){var o=e(n[i],2),s=o[0],a=o[1];r.push({type:s,props:a})}return ar("DynamicShader",{effects:r})}function Sr(e=""){return{set(t){"number"==typeof t&&(t={width:t,color:255}),this.effects=l(l({},this.effects||{}),{[`border${e}`]:t}),this[`_border${e}`]=t},get(){return this[`_border${e}`]}}}class Cr extends Object{constructor(e){super(),this._animationQueue=[],this._animationRunning=!1,this.name=e,this._renderProps={},this.children=new pr(this)}get effects(){return this._effects}set effects(e){this._effects=e,this.lng&&(this.shader=Tr(e))}get parent(){return this._parent}set parent(e){var t;(this._parent=e,this.lng)&&(this.lng.parent=null!==(t=null==e?void 0:e.lng)&&void 0!==t?t:null)}get shader(){return this._shader}set shader(e){mr(e)?this._shader=ar(...e):this._shader=e,this._sendToLightning("shader",this._shader)}_sendToLightningAnimatable(e,t){if(this.lng){if(this.transition&&(!0===this.transition||this.transition[e])){var r=!0===this.transition||!0===this.transition[e]?void 0:this.transition[e];return this.animate({[e]:t},r).start()}this.lng[e]=t}else this._renderProps[e]=t}_sendToLightning(e,t){this.lng?this.lng[e]=t:this._renderProps[e]=t}animate(e,t){return h(this.lng,"Node must be rendered before animating"),this.lng.animate(e,t||this.animationSettings)}chain(e,t){return this._animationRunning&&(this._animationQueue=[],this._animationRunning=!1),t?this._animationQueueSettings=t:this._animationQueueSettings||(this._animationQueueSettings=t||this.animationSettings),t=t||this._animationQueueSettings,this._animationQueue.push({props:e,animationSettings:t}),this}start(){var e=this;return i(t().mark((function r(){var i;return t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:i=e._animationQueue.shift();case 1:if(!i){t.next=8;break}return e._animationRunning=!0,t.next=5,e.animate(i.props,i.animationSettings).start().waitUntilStopped();case 5:i=e._animationQueue.shift(),t.next=1;break;case 8:e._animationRunning=!1,e._animationQueueSettings=void 0;case 10:case"end":return t.stop()}}),r)})))()}setFocus(){if(this.lng){if(void 0!==this.forwardFocus)if(gr(this.forwardFocus)){if(!1!==this.forwardFocus.call(this,this))return}else{var e="number"==typeof this.forwardFocus?this.forwardFocus:null;if(null!==e&&e<this.children.length){var t=this.children[e];return void(t instanceof Cr&&t.setFocus())}}queueMicrotask((()=>Ct(this)))}else this.autofocus=!0}isTextNode(){return"text"===this.name}_layoutOnLoad(){this.lng.on("loaded",((e,t)=>{var r=t.dimensions;this.parent.updateLayout(this,r)}))}getText(){return this.children.map((e=>e.text)).join("")}destroy(){var e;this._queueDelete&&(null===(e=this.lng)||void 0===e||e.destroy())}set onEvents(e){this._events=e}get onEvents(){return this._events||[]}set style(e){for(var t in mr(e)?this._style=xr(e):this._style=e,this._style)void 0===this[t]&&(this[t]=this._style[t])}get style(){return this._style}get hasChildren(){return this.children.length>0}getChildById(e){return this.children.find((t=>t.id===e))}searchChildrenById(e){for(var t=0;t<this.children.length;t++){var r=this.children[t];if(r instanceof Cr){if(r.id===e)return r;var i=r.searchChildrenById(e);if(i)return i}}}set states(e){this._states=new yr(this._stateChanged.bind(this),e),this.lng&&this._stateChanged()}get states(){return this._states=this._states||new yr(this._stateChanged.bind(this)),this._states}get animationSettings(){return this._animationSettings||wr}set animationSettings(e){this._animationSettings=e}requiresLayout(){return"flex"===this.display||this.onBeforeLayout}updateLayout(e,t){if(this.hasChildren){vr();var r,i=!1;if(gr(this.onBeforeLayout)&&(i=this.onBeforeLayout.call(this,this,e,t)),"flex"===this.display){if(function(e){for(var t=[],r=!1,i=0;i<e.children.length;i++){var n=e.children[i];if("TextNode"!==n.name&&!1!==n.flexItem){if("text"===n.name&&""!==n.text&&!n.width&&!n.height)return!1;void 0!==n.flexOrder&&(r=!0),t.push(n)}}r&&t.sort(((e,t)=>(e.flexOrder||0)-(t.flexOrder||0)));var o=t.length,s="row"===(e.flexDirection||"row"),a=s?"width":"height",l=s?"height":"width",d=s?"marginLeft":"marginTop",u=s?"marginRight":"marginBottom",c=s?"x":"y",p=s?"y":"x",f=e[a]||0,v=e[l]||0,g=e.gap||0,m=e.justifyContent||"flexStart",x=e.alignItems,y=0;["center","spaceBetween","spaceEvenly"].includes(m)&&(y=t.reduce(((e,t)=>e+(t[a]||0)),0));var w=v&&x?e=>{"flexStart"===x?e[p]=0:"center"===x?e[p]=(v-(e[l]||0))/2:"flexEnd"===x&&(e[p]=v-(e[l]||0))}:e=>e;if("flexStart"===m){var b=0;if(t.forEach((e=>{e[c]=b+(e[d]||0),b+=(e[a]||0)+g+(e[d]||0)+(e[u]||0),w(e)})),"fixed"!==e.flexBoundary){var _=b-g;if(_!==e[a])return e[a]=_,!0}}else if("flexEnd"===m)for(var T=f,S=o-1;S>=0;S--){var C=t[S];h(C),C[c]=T-(C[a]||0)-(C[u]||0),T-=(C[a]||0)+g+(C[d]||0)+(C[u]||0),w(C)}else if("center"===m){var R=(f-(y+g*(o-1)))/2;t.forEach((e=>{e[c]=R,R+=(e[a]||0)+g,w(e)}))}else if("spaceBetween"===m){var I=(f-y)/(o-1),N=0;t.forEach((e=>{e[c]=N,N+=(e[a]||0)+I,w(e)}))}else if("spaceEvenly"===m){var L=(f-y)/(o+1),M=L;t.forEach((e=>{e[c]=M,M+=(e[a]||0)+L,w(e)}))}return!1}(this)||i)null===(r=this.parent)||void 0===r||r.updateLayout()}else if(i){var n;null===(n=this.parent)||void 0===n||n.updateLayout()}gr(this.onLayout)&&this.onLayout.call(this,this,e,t)}}_stateChanged(){if(vr(0,0,this.states),this.forwardStates){var e=this.states.slice();this.children.forEach((t=>t.states=e))}var t=this.states;if(this._undoStyles||this.style&&function(e,t){var r,i=n(t);try{for(i.s();!(r=i.n()).done;)if(r.value in e)return!0}catch(o){i.e(o)}finally{i.f()}return!1}(this.style,t)){this._undoStyles=this._undoStyles||[];var r={};this._undoStyles.forEach((e=>{r[e]=this.style[e]}));var i=t.reduce(((e,t)=>{var r=this.style[t];return r&&(e=l(l({},e),r)),e}),{});this._undoStyles=Object.keys(i),void 0!==i.transition&&(this.transition=i.transition),Object.assign(this,r,i)}}render(){var e=this,t=this.parent;if(t)if(t.lng)if(this.lng)console.warn("Node already rendered: ",this);else{t.requiresLayout()&&-1===br.indexOf(t)&&(br.push(t),_r&&(_r=!1,queueMicrotask((()=>{for(_r=!0;br.length;){br.pop().updateLayout()}})))),this.states.length&&this._stateChanged();var r=e._renderProps;if(r.x=r.x||0,r.y=r.y||0,t.lng&&(r.parent=t.lng),e._effects&&(this.shader=Tr(e._effects)),e.isTextNode()){if(fr.fontSettings)for(var i in fr.fontSettings)void 0===r[i]&&(r[i]=fr.fontSettings[i]);r.text=e.getText(),r.contain&&(r.width||(r.width=(t.width||0)-r.x-(r.marginRight||0)),"both"!==r.contain||r.height||r.maxLines?1===r.maxLines&&(r.height=r.height||r.lineHeight||r.fontSize):r.height=(t.height||0)-r.y-(r.marginBottom||0)),vr(0,0),e.lng=sr.createTextNode(r),!t.requiresLayout()||r.width&&r.height||e._layoutOnLoad()}else r.texture||(isNaN(r.width)&&(r.width=(t.width||0)-r.x),isNaN(r.height)&&(r.height=(t.height||0)-r.y),r.color||r.src||(r.color=0)),vr(0,0),e.lng=sr.createNode(r);r.autosize&&t.requiresLayout()&&e._layoutOnLoad(),e.onFail&&e.lng.on("failed",e.onFail),e.onLoad&&e.lng.on("loaded",e.onLoad),gr(this.onCreate)&&this.onCreate.call(this,e),e.onEvents.forEach((([t,r])=>{var i;null===(i=e.lng)||void 0===i||i.on(t,((t,i)=>r(e,i)))})),e.lng.div&&(e.lng.div.solid=e),"text"!==e.name&&e.children.forEach((e=>{e.render?e.render():""!==e.text&&console.warn("TextNode outside of <Text>: ",e)})),e.autofocus&&e.setFocus(),this._renderProps={}}else console.warn("Parent not rendered yet: ",this);else console.warn("Parent not set - no node created for: ",this)}}for(var Rr=function(){var e=Nr[Ir];Object.defineProperty(Cr.prototype,e,{get(){return this.lng?this.lng[e]:this._renderProps[e]},set(t){this._sendToLightningAnimatable(e,t)}})},Ir=0,Nr=["alpha","color","colorTop","colorRight","colorLeft","colorBottom","colorTl","colorTr","colorBl","colorBr","height","fontSize","lineHeight","mount","mountX","mountY","pivot","pivotX","pivotY","rotation","scale","width","worldX","worldY","x","y","zIndex","zIndexLocked"];Ir<Nr.length;Ir++)Rr();for(var Lr=function(){var e=kr[Mr];Object.defineProperty(Cr.prototype,e,{get(){return this.lng?this.lng[e]:this._renderProps[e]},set(t){this._sendToLightning(e,t)}})},Mr=0,kr=["autosize","clipping","contain","fontFamily","fontStretch","fontStyle","fontWeight","letterSpacing","maxLines","offsetY","overflowSuffix","rtt","scrollable","scrollY","src","text","textAlign","textBaseline","textOverflow","texture","verticalAlign","wordWrap"];Mr<kr.length;Mr++)Lr();function Br({createElement:e,createTextNode:t,isTextNode:r,replaceText:i,insertNode:n,removeNode:o,setProperty:s,getParentNode:a,getFirstChild:l,getNextSibling:d}){function h(e,t,r,i){if(void 0===r||i||(i=[]),"function"!=typeof t)return u(e,t,i,r);rt((i=>u(e,t(),i,r)),i)}function u(e,o,s,a,d){for(;"function"==typeof s;)s=s();if(o===s)return s;var h=typeof o,m=void 0!==a;if("string"===h||"number"===h)if("number"===h&&(o=o.toString()),m){var x=s[0];x&&r(x)?i(x,o):x=t(o),s=f(e,s,a,x)}else""!==s&&"string"==typeof s?i(l(e),s=o):(f(e,s,a,t(o)),s=o);else if(null==o||"boolean"===h)s=f(e,s,a);else{if("function"===h)return rt((()=>{for(var t=o();"function"==typeof t;)t=t();s=u(e,t,s,a)})),()=>s;if(Array.isArray(o)){var y=[];if(c(y,o,d))return rt((()=>s=u(e,y,s,a,!0))),()=>s;if(0===y.length){var w=f(e,s,a);if(m)return s=w}else Array.isArray(s)?0===s.length?v(e,y,a):p(e,s,y):null==s||""===s?v(e,y):p(e,m&&s||[l(e)],y);s=y}else{if(Array.isArray(s)){if(m)return s=f(e,s,a,o);f(e,s,null,o)}else null!=s&&""!==s&&l(e)?g(e,o,l(e)):n(e,o);s=o}}return s}function c(e,r,i){for(var n=!1,o=0,s=r.length;o<s;o++){var a=r[o],l=void 0;if(null==a||!0===a||!1===a);else if(Array.isArray(a))n=c(e,a)||n;else if("string"==(l=typeof a)||"number"===l)e.push(t(a));else if("function"===l)if(i){for(;"function"==typeof a;)a=a();n=c(e,Array.isArray(a)?a:[a])||n}else e.push(a),n=!0;else e.push(a)}return n}function p(e,t,r){for(var i=r.length,s=t.length,a=i,l=0,h=0,u=d(t[s-1]),c=null;l<s||h<a;)if(t[l]!==r[h]){for(;t[s-1]===r[a-1];)s--,a--;if(s===l)for(var p=a<i?h?d(r[h-1]):r[a-h]:u;h<a;)n(e,r[h++],p);else if(a===h)for(;l<s;)c&&c.has(t[l])||o(e,t[l]),l++;else if(t[l]===r[a-1]&&r[h]===t[s-1]){var f=d(t[--s]);n(e,r[h++],d(t[l++])),n(e,r[--a],f),t[s]=r[a]}else{if(!c){c=new Map;for(var v=h;v<a;)c.set(r[v],v++)}var m=c.get(t[l]);if(null!=m)if(h<m&&m<a){for(var x=l,y=1,w=void 0;++x<s&&x<a&&null!=(w=c.get(t[x]))&&w===m+y;)y++;if(y>m-h)for(var b=t[l];h<m;)n(e,r[h++],b);else g(e,r[h++],t[l++])}else l++;else o(e,t[l++])}}else l++,h++}function f(e,r,i,s){if(void 0===i){for(var d;d=l(e);)o(e,d);return s&&n(e,s),""}var h=s||t("");if(r.length)for(var u=!1,c=r.length-1;c>=0;c--){var p=r[c];if(h!==p){var f=a(p)===e;u||c?f&&o(e,p):f?g(e,h,p):n(e,h,i)}else u=!0}else n(e,h,i);return[h]}function v(e,t,r){for(var i=0,o=t.length;i<o;i++)n(e,t[i],r)}function g(e,t,r){n(e,t,r),o(e,r)}function m(e,t,r={},i){return t||(t={}),i||rt((()=>r.children=u(e,t.children,r.children))),rt((()=>t.ref&&t.ref(e))),rt((()=>{for(var i in t)if("children"!==i&&"ref"!==i){var n=t[i];n!==r[i]&&(s(e,i,n,r[i]),r[i]=n)}})),r}return{render(e,t){var r;return et((i=>{r=i,h(t,e())})),r},insert:h,spread(e,t,r){"function"==typeof t?rt((i=>m(e,t(),i,r))):m(e,t,void 0,r)},createElement:e,createTextNode:t,insertNode:n,setProp:(e,t,r,i)=>(s(e,t,r,i),r),mergeProps:_t,effect:rt,memo:it,createComponent:mt,use:(e,t,r)=>nt((()=>e(t,r)))}}Object.defineProperties(Cr.prototype,{borderRadius:{set(e){this._borderRadius=e,this.effects=l(l({},this.effects||{}),{radius:{radius:e}})},get(){return this._borderRadius}},border:Sr(),borderLeft:Sr("Left"),borderRight:Sr("Right"),borderTop:Sr("Top"),borderBottom:Sr("Bottom")}),Object.defineProperties(Cr.prototype,{linearGradient:{set(e={}){this._linearGradient=e,this.effects=l(l({},this.effects||{}),{linearGradient:e})},get(){return this._linearGradient}}});var Fr,Er={createElement:e=>new Cr(e),createTextNode:e=>({name:"TextNode",text:e,parent:void 0}),replaceText(e,t){vr(0,0),e.text=t;var r=e.parent;h(r),r.text=r.getText()},setProperty(e,t,r=!0){e[t]=r},insertNode(e,t,r){vr(0,0),e.children.insert(t,r),t._queueDelete=!1,t instanceof Cr?e.lng&&t.render():e.isTextNode()&&(e.text=e.getText())},isTextNode:e=>e.isTextNode(),removeNode(e,t){vr(0,0),e.children.remove(t),t._queueDelete=!0,t instanceof Cr&&queueMicrotask((()=>t.destroy()))},getParentNode:e=>e.parent,getFirstChild:e=>e.children[0],getNextSibling(e){var t=e.parent.children||[],r=t.indexOf(e)+1;if(r<t.length)return t[r]}},Ar=function(e){var t=Br(e);return t.mergeProps=_t,t}(Er);function zr(e,t){return Pr.apply(this,arguments)}function Pr(){return(Pr=i(t().mark((function e(r,i){return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Fr=cr(fr.rendererOptions,i||"app"),e.next=3,Fr.init();case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}r("r",function(){var e=i(t().mark((function e(r,i){var n,o;return t().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=Er.createElement("App"),e.next=3,zr(void 0,i);case 3:return n.lng=Fr.root,o=Ar.render(r,n),e.abrupt("return",{dispose:o,rootNode:n,renderer:Fr});case 6:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}()),Ar.effect,Ar.memo;var Or=Ar.createComponent,$r=Ar.createElement,Dr=(Ar.createTextNode,Ar.insertNode,Ar.insert,Ar.spread),Yr=(Ar.setProp,Ar.mergeProps);Ar.use;r({a:Or,c:$r,s:Dr,m:Yr})}}}))}();
